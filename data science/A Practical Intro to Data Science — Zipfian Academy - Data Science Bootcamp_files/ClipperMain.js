function PageShowsVerticalScrollBar(){var n=Math.max(document.documentElement.clientHeight,document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight);return n>window.innerHeight}function GetScrollBarWidth(){var t=document.createElement("p"),n,r,i;return t.style.width="100%",t.style.height="200px",n=document.createElement("div"),n.style.position="absolute",n.style.top="0px",n.style.left="0px",n.style.visibility="hidden",n.style.width="200px",n.style.height="150px",n.style.overflow="hidden",n.appendChild(t),document.body.appendChild(n),r=t.offsetWidth,n.style.overflow="scroll",i=t.offsetWidth,r===i&&(i=n.clientWidth),document.body.removeChild(n),r-i}var __extends,Events,Utils,OneNoteApi,AugmentationApi,Clipper;(function(n){var t;(function(n){var t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it;(function(){})(t=n.Urls||(n.Urls={})),function(n){n.OneNote="OneNote Clipper"}(i=n.ClientIds||(n.ClientIds={})),function(n){var t;(function(n){n.ClipperUseCountOnThisBrowser="clipperUseCountOnThisBrowser"})(t=n.Keys||(n.Keys={}))}(r=n.Cookies||(n.Cookies={})),function(n){n.FeedbackOriginalUrlId="originalUrl";n.AuthQueryParamName="auth";n.AuthQueryParamValueMsa="1";n.AuthQueryParamValueAad="2"}(u=n.QueryParams||(n.QueryParams={})),function(n){n.CorrelationIdHeaderName="X-CorrelationId"}(f=n.Headers||(n.Headers={})),function(n){n.Anchor="a";n.Base="base";n.Br="br";n.Canvas="canvas";n.Div="div";n.IFrame="iframe";n.Image="img";n.Input="input";n.Link="link";n.NoScript="noscript";n.Script="script";n.Span="span";n.Style="style";n.Svg="svg"}(e=n.Tags||(n.Tags={})),function(n){n.AllowTransparency="allowtransparency";n.AutoFocus="autofocus";n.Direction="direction";n.HRef="href";n.Placeholder="placeholder";n.Source="src";n.Scrolling="scrolling";n.Type="type";n.Value="value";n.Name="name";n.Title="title";n.TabIndex="tabindex";n.Target="target"}(o=n.Attributes||(n.Attributes={})),function(n){n.None="none";n.True="true"}(s=n.AttributeValues||(n.AttributeValues={})),function(n){n.Css="oneNoteClipperCss";n.Js="oneNoteClipperJs";n.MainContainerClass="oneNoteClipperWindow";n.SelectedClipOption="selectedClipOption"}(h=n.Classes||(n.Classes={})),function(n){n.FeedbackButton="feedbackButton";n.CloseButton="closeButton";n.LaunchOneNoteButton="launchOneNoteButton";n.SigninButton="signinButton";n.SignoutButton="signoutButton";n.ClipButton="clipButton";n.TryAgainButton="tryAgainButton";n.BackToHomeButton="backToHomeButton";n.RegionClipCancelButton="regionClipCancelButton";n.O365BetaTag="o365BetaTag";n.CurrentUserControl="currentUserControl";n.UserSettingsContainer="userSettingsContainer";n.UserSettingsList="userSettingsList";n.ClipperUIContainer="clipperUIContainer";n.ParentClipperContainer="contentContainer";n.SignInContainer="clipperSignInContainer";n.ClipperContainer="clipperButtonContainer";n.FooterContainer="clipperFooterContainer";n.ApiProgressContainer="clipperApiProgressContainer";n.SuccessContainer="clipperSuccessContainer";n.FailureContainer="clipperFailureContainer";n.CloseButtonContainer="closeButtonContainer";n.RegionClipContainer="clipperRegionClipContainer";n.FullPageButton="fullPageButton";n.RegionModeButton="regionModeButton";n.AugmentationButton="augmentationButton";n.AugmentationButtonImage="augmentationButtonImage";n.AugmentationButtonLabel="augmentationButtonLabel";n.LocationPickerContainer="locationPickerContainer";n.AnnotationContainer="annotationContainer";n.AnnotationField="annotationField";n.AnnotationFieldContainer="annotationFieldContainer";n.AnnotationPlaceholder="annotationPlaceholder";n.ClipperUI="oneNoteClipperUI";n.PreviewUI="oneNoteAugmentedPreviewUI";n.RegionClipUI="oneNoteRegionClipUI";n.PreviewTextContainer="oneNoteAugmentedTextContainer";n.PreviewTitleElement="oneNoteAugmentedTitleContainer";n.PreviewTimestampElement="oneNotePreviewTimestamp";n.PreviewBodyElement="oneNoteAugmentedBodyContainer";n.CheckMarkContainer="checkMarkContainer";n.SpinnerInContainer="spinnerInContainer";n.SpinnerLoopContainer="spinnerLoopContainer";n.SpinnerOutContainer="spinnerOutContainer";n.ApiErrorMessage="apiErrorMessage"}(c=n.IDs||(n.IDs={})),function(n){n.ClipperUIWidth=322;n.ClipperUITopRightOffset=20;n.HorizontalSlidingAnimationBuffer=20;n.ClipperUIDropShadowBuffer=7}(l=n.Styles||(n.Styles={})),function(){}(a=n.Numbers||(n.Numbers={})),function(){}(v=n.Strings||(n.Strings={})),function(){}(y=n.Brs||(n.Brs={})),function(n){n.ClipperInfo="CLIPPER_INFO";n.PageInfo="PAGE_INFO";n.AugmentationApiStatus="AUGMENTATION_API_STATUS";n.AugmentationResponseJson="AUGMENTATION_RESPONSE_JSON"}(p=n.SmartValueKeys||(n.SmartValueKeys={})),function(n){n.CheckForNewerPageInfo="CHECK_FOR_NEWER_PAGE_INFO";n.CheckForNewerPageInfoCallback="CHECK_FOR_NEWER_PAGE_INFO_Callback";n.CloseClipper="CLOSE_CLIPPER";n.CollapseUI="COLLAPSE_UI";n.Dismiss="DISMISS";n.ExpandUI="EXPAND_UI";n.HideAllPreviews="HIDE_PREVIEW";n.RefreshContainerHeight="REFRESH_CONTAINER_HEIGHT";n.RefreshFrameHeight="REFRESH_FRAME_HEIGHT";n.ShowAugmentationPreview="SHOW_AUGMENTATION_PREVIEW";n.Telemetry="TELEMETRY";n.StartRegionMode="START_REGION_MODE";n.SelectionInProgress="SELECTION_IN_PROGRESS";n.RegionSelected="REGION_SELECTED";n.RegionNotSelected="REGION_NOT_SELECTED";n.StartRegionClip="START_REGION_CLIP";n.RegionClipComplete="REGION_CLIP_COMPLETE";n.StopRegionMode="STOP_REGION_MODE";n.TakeTabScreenshot="TAKE_TAB_SCREENSHOT";n.TakeTabScreenshotCallback="TAKE_TAB_SCREENSHOT_CALLBACK"}(w=n.FunctionKeys||(n.FunctionKeys={})),function(n){n.CaptureVisibleTab="captureVisibleTab";n.ExtensionCallbackMessage="ExtensionCallback";n.InvokeClipperCommand="ClipperInvoker";n.Ping="Ping";n.Pong="Pong"}(b=n.ExtensionMessages||(n.ExtensionMessages={})),function(n){n.MainAndExtension="EXTENSION_CHANNEL";n.MainAndUI="MAIN_AND_UI";n.MainAndRegion="MAIN_AND_REGION";n.MainAndPreview="MAIN_AND_PREVIEW"}(k=n.CommunicationChannels||(n.CommunicationChannels={})),function(n){n.RequiredVersionForRegionClipping="2.0.0"}(d=n.VersionNumbers||(n.VersionNumbers={})),function(n){n.WindowsLiveId="WindowsLiveId"}(g=n.AuthTypes||(n.AuthTypes={})),function(n){n[n.Error=0]="Error";n[n.Warning=1]="Warning";n[n.Info=2]="Info";n[n.Verbose=3]="Verbose";n[n.Spam=4]="Spam"}(n.LogLevel||(n.LogLevel={}));nt=n.LogLevel,function(n){n[n.Waiting=0]="Waiting";n[n.Success=1]="Success";n[n.NoContent=2]="NoContent";n[n.Error=3]="Error"}(n.AugmentationApiStatus||(n.AugmentationApiStatus={}));tt=n.AugmentationApiStatus,function(n){n[n.Bookmarklet=0]="Bookmarklet";n[n.ChromeExtension=1]="ChromeExtension";n[n.FirefoxExtension=2]="FirefoxExtension";n[n.SafariExtension=3]="SafariExtension"}(n.ClipperClientType||(n.ClipperClientType={}));it=n.ClipperClientType})(t=n.Constants||(n.Constants={}))})(Clipper||(Clipper={})),function(n){var t;(function(n){var t=function(){function t(t,i){this._element=n.HtmlElementFromJson(t);this._visible=!1;this._element.style.display="none";i.appendChild(this._element)}return t.prototype.GetElement=function(){return this._element},t.prototype.IsVisible=function(){return this._visible},t.prototype.Show=function(){this._visible||(clearTimeout(this._hideTimeoutHandle),this._visible=!0,this._element.style.display="",this.AnimateIn())},t.prototype.Hide=function(n){var i=this,t;(n===void 0&&(n=!1),this._visible)&&(this._visible=!1,n?this._element.style.display="none":(t=this.AnimateAway(),this._hideTimeoutHandle=setTimeout(function(){i._element.style.display="none"},t)))},t.prototype.AnimateIn=function(){},t.prototype.AnimateAway=function(){return 0},t.prototype.InitEvents=function(){},t}();n.UIElement=t})(t=n.UI||(n.UI={}))}(Clipper||(Clipper={})),function(n){var t;(function(n){var t;(function(n){var r=function(){function n(n){this._element=n;this._delay=0}return n.prototype.Animate=function(n,t,r,u){return i.Schedule(this._element,n,t,r,u,this._delay),this},n.prototype.After=function(n){return this._delay+=n,this},n.prototype.CollapseX=function(n,t){return this.Collapse(!0,n,t)},n.prototype.CollapseY=function(n,t){return this.Collapse(!1,n,t)},n.prototype.FadeIn=function(n,t){return t===void 0&&(t=100),typeof document.body.style.opacity=="string"?(Utils.SetCssAttribute(this._element,"opacity","0"),Utils.SetCssAttribute(this._element,"filter","alpha(opacity=100)"),this.Animate("opacity","0","1",n)):this.Animate("filter","alpha(opacity=0)","alpha(opacity="+t+")",n)},n.prototype.FadeOut=function(n,t){return t===void 0&&(t=100),typeof document.body.style.opacity=="string"?this.Animate("opacity","1","0",n):this.Animate("filter","alpha(opacity="+t+")","alpha(opacity=0)",n)},n.prototype.Scale=function(n,t,i){return this.Animate("-transform","scale("+t+")","scale("+i+")",n)},n.prototype.SlideX=function(n,t,i){return this.Slide(!0,n,t,i)},n.prototype.SlideY=function(n,t,i){return this.Slide(!1,n,t,i)},n.prototype.Collapse=function(n,t,i){return n?this._element.style.overflowX="hidden":this._element.style.overflowY="hidden",this.Animate(n?"width":"height",this.Px(n?this._element.clientWidth:this._element.clientHeight),this.Px(i),t)},n.prototype.Slide=function(n,t,i,r){return this.Animate(n?"margin-left":"margin-top",this.Px(i),this.Px(r),t)},n.prototype.Px=function(n){return n+"px"},n}(),i,t;n.Animation=r,function(n){function r(n,t,i){var u,r;for(i=Math.max(0,Math.min(i,1)),u=[],r=0;r<n.length;r++)u.push(n[r]+(t[r]-n[r])*i);return u}function u(){var f,u,n,e,o,s;for(i=i||[],f=(new Date).getTime(),u=0;u<i.length;u++)n=i[u],f>n.StartTime&&(e=n.TimeLength!==0?Math.min(1,(f-n.StartTime)/n.TimeLength):1,o=r(n.StartData,n.EndData,e),s=t.Encode({Data:o,Template:n.Template}),Utils.SetCssAttribute(n.Element,n.Attribute,s),e>=1&&i.splice(u--,1));window.requestAnimationFrame(arguments.callee)}function f(n,r,f,e,o,s){s===void 0&&(s=0);i=i||[];f=f||Utils.GetCssAttribute(n,r);var h=t.Decode(f);i.push({Element:n,StartTime:(new Date).getTime()+s,Attribute:r,TimeLength:o,StartData:h.Data,EndData:t.Decode(e).Data,Template:h.Template});window.requestAnimationFrame(u)}var i=[];n.Schedule=f}(i||(i={})),function(n){function t(n){for(var i=/([-]?(((\d+)\.?(\d+)?)|(\.(\d+)?)))/g,r=n.match(i),f=n.replace(i,"%f"),u=[],t=0;t<r.length;t++)u.push(parseFloat(r[t]));return{Template:f,Data:u}}function i(n){for(var u,r,t=n.Template,f=t.match(/\%[d|f]/g),i=0;i<n.Data.length;i++)u=f[i],r=n.Data[i],u==="%d"&&(r=Math.floor(r)),t=t.replace(u,r+"");return t}n.Decode=t;n.Encode=i}(t=n.CSSValueEncoding||(n.CSSValueEncoding={}))})(t=n.Animations||(n.Animations={}))})(t=n.UI||(n.UI={}))}(Clipper||(Clipper={})),function(n){var t=function(){function n(n){n===void 0&&(n=null);this._t=null;this._subscriptions=[];this._t=n}return n.prototype.Subscribe=function(n){this._subscriptions.push(n);n(this._t)},n.prototype.Set=function(n){if(this._t!==n){this._t=n;for(var t=0;t<this._subscriptions.length;t++)this._subscriptions[t](this._t)}},n.prototype.Get=function(){return this._t},n.prototype.Equals=function(n){return this._t===n},n.prototype.ToString=function(){return this._t==null?"null":this._t.toString()},n.Subscribe=function(n,t){for(var i=0;i<n.length;i++)n[i].Subscribe(function(){for(var r=[],i=0;i<n.length;i++)r.push(n[i].Get());t.apply(this,r)})},n}();n.SmartValue=t}(Utils||(Utils={})),function(n){var t;(function(t){function i(t,r){var f,u,e,o,s,h;if(r===void 0&&(r=""),typeof t.Brs=="undefined"&&(t.Brs=!0),!t.Brs)return null;if(t.Tag||(t.Tag=n.Constants.Tags.Div),u=document.createElement(t.Tag),t.Attributes)for(f=0;f<t.Attributes.length;f++)e=t.Attributes[f],u.setAttribute(e.Name,e.Value);if(t.Id&&(u.id=t.Id),t.Classes?(o=t.Classes.join(" "),r&&(o+=" "+r),u.className=o):r&&(u.className=r),t.InnerText&&(t.Tag!==n.Constants.Tags.Input?u.innerHTML=t.InnerText:u.value=t.InnerText),t.Children)for(f=0;f<t.Children.length;f++)s=t.Children[f],s&&(h=i(s,r),h&&u.appendChild(h));return u}function r(n){return new t.Animations.Animation(n)}function u(n,t,i){i.Subscribe(function(){n.setAttribute(t,i.ToString())})}function f(n,t,i,r){i.Subscribe(function(){r?Utils.SetCssAttribute(n,t,r(i.Get())):Utils.SetCssAttribute(n,t,i.ToString())})}function e(n,t){t.Subscribe(function(){var i=t.ToString();n.innerText=i;n.textContent=i})}t.HtmlElementFromJson=i;t.Animate=r;t.BindAttribute=u;t.BindCssAttribute=f;t.BindInnerText=e})(t=n.UI||(n.UI={}))}(Clipper||(Clipper={})),function(n){function u(n){n===void 0&&(n=document);var t=n.getElementsByTagName("html")[0].getAttribute("lang");return t?t:window.navigator.userLanguage||window.navigator.language}function t(n,t,i){i===void 0&&(i=null);var r=n+"="+t;i&&(r+=";expires="+i.toUTCString());r+=";secure";document.cookie=r}function f(n){t(n,"",new Date("2000-01-01"))}function e(n){var t=document.cookie.match("(^|;) ?"+n+"=([^;]*)(;|$)");return t?t[2]:null}function o(n){return n.preventDefault(),n.stopPropagation(),!1}function s(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=Math.random()*16|0,i=n==="x"?t:t&3|8;return i.toString(16)})}function h(n,t,i){var r=document.createElement("link"),u;r.rel="stylesheet";r.type="text/css";r.href=n;r.className=t;document.head.appendChild(r);i&&(u=new Image,u.onerror=i,u.src=n)}function c(n,t){return window.getComputedStyle?getComputedStyle(n).getPropertyValue(t):n.currentStyle[t]}function l(n,t,i){var u=[t],r;for(t[0]==="-"&&(u=["-ms"+t,"-moz"+t,"-webkit"+t,"-o"+t,t.substr(1)]),r=0;r<u.length;r++)n.style.setProperty?n.style.setProperty(u[r],i):n.style.setAttribute(u[r],i)}function a(n,t,i){var r=n;return r+=-1===r.indexOf("?")?"?":"&",r+(t+"="+i)}function i(n,t,i){var r=new XMLHttpRequest;r.open("GET","https://"+n+"/count/"+t+"?"+i);r.send()}function v(n,t,i){i===void 0&&(i="");var u=r(n,[t]);return u[t]==null||u[t]===""?i:u[t]}function r(n,t){try{var r=new XMLHttpRequest;return r.open("GET","https://"+n+"/Strings?ids="+t.join(),!1),r.send(),JSON.parse(r.responseText)}catch(u){return i(n,"StringsUtil","error="+u),{}}}function y(n){var t=!1;typeof Storage!="undefined"&&(t=localStorage.getItem("EnableConsoleLogging")==="true");t&&console.log(n)}n.GetLocale=u;n.SetCookie=t;n.ExpireCookie=f;n.GetCookie=e;n.DisableClick=o;n.GenerateGuid=s;n.LoadCSS=h;n.GetCssAttribute=c;n.SetCssAttribute=l;n.AddUrlQueryValue=a;n.SendDataToCountEndpoint=i;n.GetLocalizedStringFromServer=v;n.GetLocalizedStringsFromServer=r;n.LogToConsole=y}(Utils||(Utils={}));__extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r},function(n){var t=function(t){function i(r){var u=Utils.AddUrlQueryValue(n.Constants.Urls.ClipperUI,"OriginDomain",i.ExtractClippedDomain(window.location)),f={Id:n.Constants.IDs.ClipperUI,Tag:n.Constants.Tags.IFrame,Attributes:[{Name:n.Constants.Attributes.Source,Value:u},{Name:n.Constants.Attributes.AllowTransparency,Value:n.Constants.AttributeValues.True},{Name:n.Constants.Attributes.Name,Value:n.Constants.IDs.ClipperUI},{Name:"marginheight",Value:"0"},{Name:"marginwidth",Value:"0"},{Name:"frameborder",Value:"0"}]};t.call(this,f,r)}return __extends(i,t),i.prototype.AnimateAway=function(){return 500},i.ExtractClippedDomain=function(n){var t=n.hostname,i;return t===""&&(t=n.protocol,t==="file:"&&(i=/^.*\.(.*)$/,i.exec(n.pathname)!=null&&(t+=RegExp.$1.toLowerCase()))),t},i}(n.UI.UIElement);n.MainUiElement=t}(Clipper||(Clipper={})),function(n){var t=function(t){function i(i){this._timeout=300;var r={Id:n.Constants.IDs.PreviewUI,Tag:n.Constants.Tags.IFrame,Attributes:[{Name:n.Constants.Attributes.Name,Value:n.Constants.IDs.PreviewUI},{Name:n.Constants.Attributes.Source,Value:n.Constants.Urls.AugmentedPreview}]};t.call(this,r,i)}return __extends(i,t),i.prototype.Show=function(){document.body.className+=" oneNoteClipperPreviewDisableScroll";t.prototype.Show.call(this)},i.prototype.Hide=function(){document.body.className=document.body.className.replace(/(?:^|\s)oneNoteClipperPreviewDisableScroll(?!\S)/g,"");t.prototype.Hide.call(this)},i.prototype.AnimateIn=function(){return n.UI.Animate(t.prototype.GetElement.call(this)).FadeIn(this._timeout),this._timeout},i.prototype.AnimateAway=function(){return n.UI.Animate(t.prototype.GetElement.call(this)).FadeOut(this._timeout),this._timeout},i}(n.UI.UIElement);n.AugmentedPreviewUiElement=t}(Clipper||(Clipper={})),function(n){var t=function(t){function i(i){this._timeout=300;var r={Id:n.Constants.IDs.RegionClipUI,Tag:n.Constants.Tags.IFrame,Attributes:[{Name:n.Constants.Attributes.Source,Value:n.Constants.Urls.RegionClipper}]};t.call(this,r,i)}return __extends(i,t),i.prototype.AnimateIn=function(){return n.UI.Animate(t.prototype.GetElement.call(this)).FadeIn(this._timeout),this._timeout},i.prototype.AnimateAway=function(){return n.UI.Animate(t.prototype.GetElement.call(this)).FadeOut(this._timeout),this._timeout},i}(n.UI.UIElement);n.RegionClipUIElement=t}(Clipper||(Clipper={})),function(n){function t(n,t,i){n.addEventListener?n.addEventListener(t,i):n.attachEvent("on"+t,i);r.push({Element:n,Type:t,Listener:i})}function u(n,t,i){n.removeEventListener?n.removeEventListener(t,i):n.detachEvent("on"+t,i)}function o(n,t){var i=document.getElementById(n);i!=null&&e(i,t)}function f(n,t,i){n.style[t]!==i&&(n.style.setProperty?n.style.setProperty(t,i):n.style.setAttribute(t,i))}function e(n,r){t(n,"mousedown",function(){f(n,"outline-style","none")});t(n,"click",r);t(n,"keyup",function(t){document.activeElement===n&&(t.keyCode===i.Enter?(n.tagName==="a"||n.tagName==="A")&&n.hasAttribute("href")||r(t):t.keyCode===i.Tab&&f(n,"outline-style",""))})}function s(n,i,r){var u=document.getElementById(n);u&&t(u,i,r)}function h(n,i){t(window,n,i)}function c(t){n.RegisterWindowEventListener("keyup",function(n){n.keyCode===i.Esc&&t(n)})}function l(){for(var t,n=0;n<r.length;n++)t=r[n],u(t.Element,t.Type,t.Listener)}var i,r;(function(n){n.Tab=9;n.Enter=13;n.Esc=27})(i=n.KeyCode||(n.KeyCode={}));r=[];n.AddEventListener=t;n.RemoveEventListener=u;n.RegisterAccesibleSelectionListener=o;n.RegisterAccesibleSelectionListenerByElement=e;n.RegisterEventListenerById=s;n.RegisterWindowEventListener=h;n.RegisterEscListener=c;n.DismissAllListeners=l}(Events||(Events={})),function(n){var t=function(){function n(n,t){var i=this;this._otherSideInitialized=!1;this._otherSideKeys=[];this._thisSideKeys=[];this._queuedCalls={};this._functionMap={};this._registrationKey="REGISTER-FUNCTION-234234f24";this._initializationKey="INIT-3n083nk6";this._setValuePrefix="SETVALUE-";this.handleMessage=function(n){var t,u,f,r,e,o;try{t=JSON.parse(n.data)}catch(s){return}if(t.commId!==i._myUniqueCommId&&(!i._channel||t.channel&&t.channel===i._channel)&&(i._channel||t.channel==null)){if(t.functionKey===i._registrationKey){if(u=t.data.toString(),i._otherSideKeys.push(u),i.OnNewFunctionAvailable(u),i._queuedCalls[u])for(f=i._queuedCalls[u],r=0;r<f.length;r++)i.PostMessage(f[r])}else if(t.functionKey===i._initializationKey)for(i._otherSideInitialized=!0,t.data&&i.SendInitializationMessage(!1),r=0;r<i._thisSideKeys.length;r++)i.PostMessage({functionKey:i._registrationKey,data:i._thisSideKeys[r]});else e=i._functionMap[t.functionKey],e&&(o=e(t.data),t.callbackKey&&i.CallRemoteFunction(t.callbackKey,o));n.stopPropagation?n.stopPropagation():n.cancelBubble=!0}};this._getOtherWindow=n;this._channel=t;this._myUniqueCommId=this.CreateUniqueId();Events.RegisterWindowEventListener("message",this.handleMessage);this.SendInitializationMessage(!0)}return n.prototype.SendInitializationMessage=function(n){this.PostMessage({functionKey:this._initializationKey,data:n})},n.prototype.RegisterFunction=function(n,t){this._functionMap[n]=t;this._otherSideInitialized&&this.PostMessage({functionKey:this._registrationKey,data:n});this._thisSideKeys.push(n)},n.prototype.CallRemoteFunction=function(n,t,i){var r={functionKey:n,data:t};i&&(r.callbackKey=i);this._otherSideKeys.indexOf(n)>=0?this.PostMessage(r):(this._queuedCalls[n]=this._queuedCalls[n]||[],this._queuedCalls[n].push(r))},n.prototype.SubscribeAcrossCommunicator=function(n,t){this.RegisterFunction(this._setValuePrefix+t,function(t){n.Set(t)})},n.prototype.BroadcastAcrossCommunicator=function(n,t){var i=this;n.Subscribe(function(n){i.CallRemoteFunction(i._setValuePrefix+t,n)})},n.prototype.OnNewFunctionAvailable=function(){},n.prototype.Dismiss=function(){Events.RemoveEventListener(window,"message",this.handleMessage)},n.prototype.PostMessage=function(n){this._channel&&(n.channel=this._channel);n.commId=this._myUniqueCommId;this._getOtherWindow().postMessage(JSON.stringify(n),"*")},n.prototype.CreateUniqueId=function(){for(var r,t="",n=Date.now(),i=0;i<16;i++)r=(n+Math.random()*16)%16|0,t+=r.toString(16),n=Math.floor(n/16);return t},n}();n.Communicator=t}(Utils||(Utils={})),function(n){var t=function(){function n(n,t){this.SmartValue=n;typeof t=="function"?(this._useConditional=!0,this._conditional=t):(this._useConditional=!1,this._expectedValue=t)}return n.prototype.IsTrue=function(){return this._useConditional?this._conditional(this.SmartValue.Get()):this.SmartValue.Equals(this._expectedValue)},n.Lock=function(n,t,i){var u,f,r;for(i===void 0&&(i=!1),u=!1,f=[],r=0;r<n.length;r++)f.push(n[r].SmartValue);Utils.SmartValue.Subscribe(f,function(){var r,f;if(!u){for(r=!0,f=0;f<n.length;f++)r=r&&n[f].IsTrue();r&&(t(),u=!i)}})},n}(),i,r;n.Condition=t;i=function(n){function t(t){n.call(this,t,function(n){return n!=null})}return __extends(t,n),t}(t);n.IsNotNullCondition=i;r=function(n){function t(t){n.call(this,t,function(n){return n})}return __extends(t,n),t}(t);n.IsTrueCondition=r}(Clipper||(Clipper={})),function(n){var t=function(n){function t(t,i){var r=this;n.call(this);Utils.SmartValue.Subscribe(t,function(){for(var f,u=[],n=0;n<t.length;n++)u.push(t[n].Get());f=i.apply(null,u);r.Set(f,!0)})}return __extends(t,n),t.prototype.Set=function(t,i){i===void 0&&(i=!1);i&&n.prototype.Set.call(this,t)},t}(Utils.SmartValue);n.DependentValue=t}(Clipper||(Clipper={})),function(n){(function(n){n[n.Html=0]="Html";n[n.Image=1]="Image";n[n.EnhancedUrl=2]="EnhancedUrl";n[n.Url=3]="Url";n[n.Onml=4]="Onml"})(n.ClipTypes||(n.ClipTypes={}));var t=n.ClipTypes}(OneNoteApi||(OneNoteApi={})),function(n){var t;(function(n){var t=function(){function t(t,i){this._doc=t;this._dom=n.GetDoctype(t)+n.ElementOuterHtml(t.documentElement);this._bytesLeft=i-n.GetByteSize(this._dom)}return t.prototype.Replace=function(t,i){var u,f,r,e;for(i===void 0&&(i=function(){return""}),u=this._doc.querySelectorAll(t),f=0,r=0;r<u.length;r++){var o=u[r],s=n.ElementOuterHtml(o),h=n.GetByteSize(s);this._bytesLeft+=h;try{e=i(o,this._bytesLeft);this._dom=this._dom.replace(s,e);this._bytesLeft-=n.GetByteSize(e);f++}catch(c){this._bytesLeft-=h}}return f},t.prototype.GetDom=function(){return this._dom},t}();n.DomStringReplacer=t})(t=n.DomUtils||(n.DomUtils={}))}(Clipper||(Clipper={})),function(n){var t;(function(t){function l(n){var t=o(n);return{ContentType:t,ContentData:f(n),ContentLocale:Utils.GetLocale(n),ContentTitle:t===2?p(n):n.title,RawUrl:n.URL,CanonicalUrl:a(n)}}function a(n){var t=n.querySelectorAll("link[rel=canonical]"),i,u,r;if(t.length===0)return n.URL;for(i=t[0].href,r=1;r<t.length;r++)u=t.item(r).href,u.length<i.length&&(i=u);return i}function f(i){var f,r,h,l,o;return w(i),e(i),f=new t.DomStringReplacer(i,n.Constants.Brs.MaxPartLength),v(f),y(f,i),r=f.GetDom(),h=n.Constants.Brs.MaxPartLength-c(r)-15,h>0&&n.Constants.Brs.InlineCssDomainWhiteList.indexOf(i.domain)>=0&&(l=r.match(/(<(head|HEAD)(\s.*?)?[^?]?>)/)[0]||"<head>",o=s(i),o=u(o,h),r=r.replace(l,l+"<head><style>"+o+"<\/style>")),u(r,n.Constants.Brs.MaxPartLength)}function e(t){var u,r,i,f,e;if(n.Constants.Brs.ImageMetadataEnabled)for(u=t.getElementsByTagName("img"),r=0;r<u.length;r++)i=u[r],i.hasAttribute("data-height")||(f=i.height,i.setAttribute("data-height",f.toString())),i.hasAttribute("data-width")||(e=i.width,i.setAttribute("data-width",e.toString()))}function v(t){var u=["#"+n.Constants.IDs.MainContainer,"#"+n.Constants.IDs.ClipperMainScript,"."+n.Constants.Classes.Css,n.Constants.Tags.Script,n.Constants.Tags.NoScript,n.Constants.Tags.Svg],r;t.Replace(u.join());r=".trc_rbox_container";t.Replace(n.Constants.Tags.Style,function(n){var t=n;return t.innerHTML.indexOf(r)>=0?"":i(t)});t.Replace(r)}function y(t,r){t.Replace(n.Constants.Tags.Canvas,function(t,u){var h=t,e,o,f,s;if(u>0){o=.1;f=1+o;do f-=o,e=h.toDataURL("image/jpeg",f);while(f>0&&e.length*4>u);return s=r.createElement(n.Constants.Tags.Image),s.src=e,i(s)}return i(h)});t.Replace(n.Constants.Tags.IFrame,function(t){var r=t,u=r.src,f,e,o;return u.indexOf("chrome-extension://")===0||u.indexOf("safari-extension://")===0||u.indexOf("firefox-extension://")===0||u.indexOf("file://")===0?"":n.Constants.Brs.InlineIFrames?(f=r.contentDocument?r.contentDocument:r.contentWindow.document,e=h(f)+i(f.head)+i(f.body),e=e.replace(/(\r\n|\n|\r)/gm,""),o=r.cloneNode(!0),o.src="",o.setAttribute("srcdoc",e),i(o)):i(r)})}function p(n){var t=n.createElement("a"),i;return(t.href=n.URL,t.pathname.match(new RegExp(".pdf$","gi"))!=null&&(i=t.pathname.match(/[^/]+$/g),i!=null))?decodeURIComponent(i.pop()):n.title}function o(n){var i=n.createElement("a"),t;return(i.href=n.URL,/\.pdf$/i.test(i.pathname)&&((t=n.querySelector("embed"),t&&/application\/pdf/i.test(t.type))||window&&window.PDFJS))?2:0}function i(n){if(n.outerHTML)return n.outerHTML;var t=document.createElement("div");return t.appendChild(n.cloneNode(!0)),t.innerHTML}function s(n){for(var t,i,o,r,f=n.styleSheets,e="",u=0;u<f.length;u++){t=f[u];try{if(i=t.rules||t.cssRules,o=t.href==null,i&&!o)for(r=0;r<i.length;r++)e+=i[r].cssText+" "}catch(s){}}return e}function w(t){var r=t.head.getElementsByTagName(n.Constants.Tags.Base),i;r.length===0&&(i=t.createElement(n.Constants.Tags.Base),i.href=b(t.location.href),t.head.insertBefore(i,t.head.firstChild))}function b(n){return n=n.split("#")[0],n=n.split("?")[0],n.substr(0,n.lastIndexOf("/")+1)}function h(n){var t=n.doctype;return t==null?"":"<!DOCTYPE "+t.name+(t.publicId?' PUBLIC "'+t.publicId+'"':"")+(!t.publicId&&t.systemId?" SYSTEM":"")+(t.systemId?' "'+t.systemId+'"':"")+">"}function r(n){return encodeURIComponent(n).match(/%..|./g)||[]}function c(n){return unescape?unescape(encodeURIComponent(n)).length:r(n).length}function u(n,t){var i,u;if(t>=n.length*4||(i=r(n),i.length<=t))return n;for(i=i.slice(0,t),u=i.join("");u.length;)try{return u=u.slice(0,-1),decodeURIComponent(u)}catch(f){}return""}t.CreatePageInfo=l;t.GetCleanDom=f;t.AddImageSizeInformationToDom=e;t.GetPageContentType=o;t.ElementOuterHtml=i;t.GetSameDomainCssRules=s;t.GetDoctype=h;t.GetByteArray=r;t.GetByteSize=c;t.TruncateStringToByteSize=u})(t=n.DomUtils||(n.DomUtils={}))}(Clipper||(Clipper={})),function(n){var t;(function(n){function i(n,t){var i=n.className.split(" ");return i.indexOf(t)>=0}function t(n){for(var r,u=this.getElementsByTagName("*"),f=[],t=0;t<u.length;t++)r=u[t],i(r,n)&&f.push(r);return f}function r(n){for(var t=0;t<this.length;t++)if(this[t]===n)return t;return-1}function u(n){setTimeout(function(){n(Date.now())},16)}function f(){var n,i;if(typeof JSON=="undefined"||!JSON.parse||!JSON.stringify||JSON.stringify([])==='"[]"'&&(delete Array.prototype.toJSON,JSON.stringify([])==='"[]"'))return!1;if(typeof Element!="undefined")Element.prototype?Element.prototype.getElementsByClassName||(Element.prototype.getElementsByClassName=t):HTMLElement&&HTMLElement.prototype&&(HTMLElement.prototype.getElementsByClassName||(HTMLElement.prototype.getElementsByClassName=t)),HTMLAnchorElement&&!HTMLAnchorElement.prototype.getElementsByClassName&&(HTMLAnchorElement.prototype.getElementsByClassName=t),document.getElementsByClassName||(document.getElementsByClassName=t);else return!1;return Array.prototype.indexOf||(Array.prototype.indexOf=r),document.head||(n=document.getElementsByTagName("head"),n.length===0&&(i=document.createElement("head"),document.body.parentNode.appendChild(i)),document.head=document.getElementsByTagName("head")[0]),document.body.tagName.toLowerCase()!=="body"&&(document.body.appendChild=function(n){return document.body.parentElement.appendChild(n)}),window.requestAnimationFrame||(window.requestAnimationFrame=window.msRequestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.oRequestAnimationFrame||u),Array.prototype.forEach||(Array.prototype.forEach=function(n,t){for(var r=this.length,i=0;i<r;i++)i in this&&n.call(t,this[i],i,this)}),!0}n.Init=f})(t=n.Polyfills||(n.Polyfills={}))}(Clipper||(Clipper={})),function(n){function t(n){var t=n.split("."),i=parseInt(t[0])||0,r=parseInt(t[1])||0,u=parseInt(t[2])||0;return{Major:i,Minor:r,Build:u}}function r(n,r){if(n==null||r==null)throw"Values can't be null";return i(t(n),t(r))}function i(n,t){if(n==null||t==null)throw"Values can't be null";return n.Major>t.Major?-1:n.Major<t.Major?1:n.Minor>t.Minor?-1:n.Minor<t.Minor?1:n.Build>t.Build?-1:n.Build<t.Build?1:0}n.ParseVersion=t;n.CompareVersionStr=r;n.CompareVersions=i}(Clipper||(Clipper={})),function(n){var t=function(){function n(){}return n.prototype.Augment=function(n,t,i,r){if(!t||t.length===0)throw"DOM parameter is null or empty";if(!i||i.length===0)throw"URL parameter is null or empty";if(!r||r.length===0)throw"sessionId parameter is null or empty";var u={"X-UserSessionId":r};$.ajax({url:"/onaugmentation/extract/v1.0/?renderMethod=extractAggressive&url="+i,type:"POST",contentType:"text/html",dataType:"json",data:t,success:n.success,error:n.error,headers:u})},n}();n.AugmentationApi=t}(AugmentationApi||(AugmentationApi={})),function(n){function i(){try{document.getElementById(n.Constants.IDs.MainContainer)==null||n.ClipperMainObject==null?n.SupportedBrowser?document.location.href==="about:blank"||document.location.href==="swappedout://"?alert(n.Constants.Strings.AbortError):n.ClipperMainObject=new t:alert(n.Constants.Strings.UnsupportedBrowserError):n.ClipperMainObject.ToggleVisibility();clearTimeout(NoOpDetectionId)}catch(i){clearTimeout(NoOpDetectionId);NoOpProgress="Unhandled ClipperMain Exception";NoOpException=encodeURIComponent(i);NoOpDetected()}}n.ClipperMainObject;n.SupportedBrowser;var t=function(){function t(){var t=this,r,i,u;this._containerElement=document.getElementById(n.Constants.IDs.MainContainer);this._containerElement||(r={Id:n.Constants.IDs.MainContainer},this._containerElement=n.UI.HtmlElementFromJson(r,n.Constants.Classes.MainContainerClass),document.body.appendChild(this._containerElement),Utils.LoadCSS(n.Constants.Urls.ClipperMainCss,n.Constants.Classes.Css,function(){t.InitializePreviewUIPosition()}),window.onresize=function(){t.RefreshPreviewUIPosition()});this._clipperUiElement=new n.MainUiElement(this._containerElement);this._clipperUiElement.Show();this._mainUiCommunicator=new Utils.Communicator(function(){return t._clipperUiElement.GetElement().contentWindow},n.Constants.CommunicationChannels.MainAndUI);this._pageInfo=new Utils.SmartValue(n.DomUtils.CreatePageInfo(document));this._mainUiCommunicator.BroadcastAcrossCommunicator(this._pageInfo,n.Constants.SmartValueKeys.PageInfo);this._mainUiCommunicator.BroadcastAcrossCommunicator(new Utils.SmartValue(ClipperInfo),n.Constants.SmartValueKeys.ClipperInfo);this._mainUiCommunicator.RegisterFunction(n.Constants.FunctionKeys.CheckForNewerPageInfo,function(){t.UpdatePageInfoIfUrlChanged();t._mainUiCommunicator.CallRemoteFunction(n.Constants.FunctionKeys.CheckForNewerPageInfoCallback)});i=function(){t._clipperUiElement.IsVisible()&&t.ToggleVisibility()};this._mainUiCommunicator.RegisterFunction(n.Constants.FunctionKeys.CloseClipper,i);Events.RegisterEscListener(i);this._mainUiCommunicator.RegisterFunction(n.Constants.FunctionKeys.RefreshContainerHeight,function(t){var i=document.getElementById(n.Constants.IDs.ClipperUI),r;r=i.clientHeight>t.newHeight?t.animationTime+100:0;clearTimeout(u);u=setTimeout(function(){Utils.SetCssAttribute(i,"height",t.newHeight+"px")},r)});this._mainUiCommunicator.CallRemoteFunction(n.Constants.FunctionKeys.Telemetry,{Level:2,Log:ClipperInfo});this.InitializeAugmentationPreviewUI();this.InitializeRegionClippingIfEnabled()}return t.prototype.UpdatePageInfoIfUrlChanged=function(){document.URL!==this._pageInfo.Get().RawUrl&&this.UpdatePageInfo()},t.prototype.UpdatePageInfo=function(){this._pageInfo.Set(n.DomUtils.CreatePageInfo(document))},t.prototype.InitializeRegionClippingIfEnabled=function(){var t=this;n.Constants.Brs.RegionClipEnabled&&n.Constants.ClipperClientType[ClipperInfo.ClipperType]!==0&&n.CompareVersionStr(n.Constants.VersionNumbers.RequiredVersionForRegionClipping,ClipperInfo.ClipperVersion)>=0&&(this._regionClipUiElement=new n.RegionClipUIElement(this._containerElement),this._regionClipIframeCommunicator=new Utils.Communicator(function(){return t._regionClipUiElement.GetElement().contentWindow},n.Constants.CommunicationChannels.MainAndRegion),this._extensionCommunicator=new Utils.Communicator(function(){return window},n.Constants.CommunicationChannels.MainAndExtension),this._mainUiCommunicator.RegisterFunction(n.Constants.FunctionKeys.StartRegionMode,function(){t._regionClipIframeCommunicator.CallRemoteFunction(n.Constants.FunctionKeys.StartRegionMode);t._regionClipUiElement.Show()}),this._mainUiCommunicator.RegisterFunction(n.Constants.FunctionKeys.StopRegionMode,function(){t._regionClipIframeCommunicator.CallRemoteFunction(n.Constants.FunctionKeys.StopRegionMode);t._regionClipUiElement.Hide()}),this._mainUiCommunicator.RegisterFunction(n.Constants.FunctionKeys.StartRegionClip,function(){var i=t._clipperUiElement.GetElement().getBoundingClientRect(),r={right:i.right,left:i.left,bottom:i.bottom,top:i.top,height:i.height,width:i.width};t._regionClipIframeCommunicator.CallRemoteFunction(n.Constants.FunctionKeys.StartRegionClip,r)}),this._regionClipIframeCommunicator.RegisterFunction(n.Constants.FunctionKeys.SelectionInProgress,function(){t._clipperUiElement.Hide(!0)}),this._regionClipIframeCommunicator.RegisterFunction(n.Constants.FunctionKeys.RegionSelected,function(){t._mainUiCommunicator.CallRemoteFunction(n.Constants.FunctionKeys.RegionSelected);t._clipperUiElement.Show()}),this._regionClipIframeCommunicator.RegisterFunction(n.Constants.FunctionKeys.RegionNotSelected,function(){t._mainUiCommunicator.CallRemoteFunction(n.Constants.FunctionKeys.RegionNotSelected);t._clipperUiElement.Show()}),this._regionClipIframeCommunicator.RegisterFunction(n.Constants.FunctionKeys.RegionClipComplete,function(i){t._clipperUiElement.Show();t._mainUiCommunicator.CallRemoteFunction(n.Constants.FunctionKeys.RegionClipComplete,i)}),this._regionClipIframeCommunicator.RegisterFunction(n.Constants.FunctionKeys.Telemetry,function(i){t._mainUiCommunicator.CallRemoteFunction(n.Constants.FunctionKeys.Telemetry,i)}),this._regionClipIframeCommunicator.RegisterFunction(n.Constants.FunctionKeys.TakeTabScreenshot,function(){t._extensionCommunicator.CallRemoteFunction(n.Constants.FunctionKeys.TakeTabScreenshot)}),this._extensionCommunicator.RegisterFunction(n.Constants.FunctionKeys.TakeTabScreenshotCallback,function(i){t._regionClipIframeCommunicator.CallRemoteFunction(n.Constants.FunctionKeys.TakeTabScreenshotCallback,i)}))},t.prototype.InitializeAugmentationPreviewUI=function(){var t=this;this._previewUiElement=new n.AugmentedPreviewUiElement(this._containerElement);this._previewCommunicator=new Utils.Communicator(function(){return t._previewUiElement.GetElement().contentWindow},n.Constants.CommunicationChannels.MainAndPreview);this._previewCommunicator.BroadcastAcrossCommunicator(this._pageInfo,n.Constants.SmartValueKeys.PageInfo);this._augmentationApiStatus=new Utils.SmartValue(0);this._mainUiCommunicator.SubscribeAcrossCommunicator(this._augmentationApiStatus,n.Constants.SmartValueKeys.AugmentationApiStatus);this._augmentationApiStatus.Subscribe(function(){t._previewCommunicator.BroadcastAcrossCommunicator(t._augmentationApiStatus,n.Constants.SmartValueKeys.AugmentationApiStatus)});this._augmentationReplyJson=new Utils.SmartValue(null);this._mainUiCommunicator.SubscribeAcrossCommunicator(this._augmentationReplyJson,n.Constants.SmartValueKeys.AugmentationResponseJson);this._augmentationReplyJson.Subscribe(function(){t._previewCommunicator.BroadcastAcrossCommunicator(t._augmentationReplyJson,n.Constants.SmartValueKeys.AugmentationResponseJson)});this._mainUiCommunicator.RegisterFunction(n.Constants.FunctionKeys.HideAllPreviews,function(){t.HideAllPreviews()});this._mainUiCommunicator.RegisterFunction(n.Constants.FunctionKeys.ShowAugmentationPreview,function(){t.UpdatePageInfoIfUrlChanged();t._previewCommunicator.CallRemoteFunction(n.Constants.FunctionKeys.ShowAugmentationPreview);t.RefreshPreviewUIPosition();t._previewUiElement.Show()})},t.prototype.InitializePreviewUIPosition=function(){var t=document.getElementById(n.Constants.IDs.PreviewUI),i=document.getElementById(n.Constants.IDs.ClipperUI);Utils.GetCssAttribute(i,"right")!==""?(this._previewSideBorderAttr="border-left-width",this._previewOppositeBorderAttr="border-right-width"):(this._previewSideBorderAttr="border-right-width",this._previewOppositeBorderAttr="border-left-width");this._previewMinWidth=parseFloat(Utils.GetCssAttribute(t,"min-width"));this._previewMaxWidth=parseFloat(Utils.GetCssAttribute(t,"max-width"))},t.prototype.RefreshPreviewUIPosition=function(){var i=document.getElementById(n.Constants.IDs.PreviewUI),o,f;if(i){var t=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,s=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,e=this._previewMaxWidth,r,u;this._previewMaxWidth+n.Constants.Styles.ClipperUIWidth+n.Constants.Styles.ClipperUITopRightOffset>t?(e=t-n.Constants.Styles.ClipperUIWidth-n.Constants.Styles.ClipperUITopRightOffset,r=0,u=t-Math.max(e,this._previewMinWidth)):(t-this._previewMaxWidth)/2<n.Constants.Styles.ClipperUIWidth+n.Constants.Styles.ClipperUITopRightOffset?(r=(t-n.Constants.Styles.ClipperUIWidth-n.Constants.Styles.ClipperUITopRightOffset-this._previewMaxWidth)/2,u=t-this._previewMaxWidth-r):(o=(t-this._previewMaxWidth)/2,r=o,u=o);Utils.SetCssAttribute(i,"width",e+"px");Utils.SetCssAttribute(i,this._previewSideBorderAttr,r+"px");Utils.SetCssAttribute(i,this._previewOppositeBorderAttr,u+"px");f=s-n.Constants.Styles.ClipperUITopRightOffset*2;f<0&&(f=0);i.style.height=f+"px"}},t.prototype.ToggleVisibility=function(){this._clipperUiElement.IsVisible()?(this._uiClosedWithAugmentedOptionSelected=this._previewUiElement?this._previewUiElement.IsVisible():!1,this.HideAllPreviews(),this._mainUiCommunicator.CallRemoteFunction(n.Constants.FunctionKeys.CollapseUI),this._clipperUiElement.Hide(),this._mainUiCommunicator.CallRemoteFunction(n.Constants.FunctionKeys.Telemetry,{Level:2,Log:{Message:"Hide Clipper UI on repeat invoke"}})):(this.UpdatePageInfo(),this.RefreshPreviewUIPosition(),this._uiClosedWithAugmentedOptionSelected&&this._previewUiElement.Show(),this._mainUiCommunicator.CallRemoteFunction(n.Constants.FunctionKeys.ExpandUI),this._clipperUiElement.Show(),this._mainUiCommunicator.CallRemoteFunction(n.Constants.FunctionKeys.Telemetry,{Level:2,Log:{Message:"Show Clipper UI on repeat invoke"}}))},t.prototype.HideAllPreviews=function(){this._previewUiElement&&this._previewUiElement.Hide();this._regionClipUiElement&&(this._regionClipIframeCommunicator.CallRemoteFunction(n.Constants.FunctionKeys.StopRegionMode),this._regionClipUiElement.Hide())},t}();n.ClipperMain=t;n.Main=i}(Clipper||(Clipper={}));Clipper.SupportedBrowser=Clipper.Polyfills.Init();Clipper.Main();