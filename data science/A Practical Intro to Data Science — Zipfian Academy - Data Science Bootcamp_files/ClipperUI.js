function GetOSPlatform(){return _osPlatform?_osPlatform:_osPlatform=$("body").hasClass(OSPlatform.IPHONE)?OSPlatform.IPHONE:$("body").hasClass(OSPlatform.IPOD)?OSPlatform.IPOD:$("body").hasClass(OSPlatform.IPAD)?OSPlatform.IPAD:$("body").hasClass(OSPlatform.ANDROID)?OSPlatform.ANDROID:$("body").hasClass(OSPlatform.WINDOWSPHONE10)?OSPlatform.WINDOWSPHONE10:$("body").hasClass(OSPlatform.WINDOWSPHONE8)?OSPlatform.WINDOWSPHONE8:$("body").hasClass(OSPlatform.WINDOWSPHONE7)?OSPlatform.WINDOWSPHONE7:$("body").hasClass(OSPlatform.WINDOWS10)?OSPlatform.WINDOWS10:$("body").hasClass(OSPlatform.WINDOWS8)?OSPlatform.WINDOWS8:$("body").hasClass(OSPlatform.WINDOWS7)?OSPlatform.WINDOWS7:$("body").hasClass(OSPlatform.WINDOWSVISTAANDBELOW)?OSPlatform.WINDOWSVISTAANDBELOW:$("body").hasClass(OSPlatform.MAC)?OSPlatform.MAC:$("body").hasClass(OSPlatform.CHROMEBOOK)?OSPlatform.CHROMEBOOK:OSPlatform.UNSUPPORTED}function InitializeUls(n){var t=!1;return n||(n=400,t=!0),TheUlsHost=new Diag.ConsoleUlsHost(n),Diag.ULS.setUlsHost(TheUlsHost),t&&Diag.ULS.sendTraceTag(6160855,TheUlsHost.DefaultCategory(),Diag.ULSTraceLevel.error,"Unknown uls category passed to InitializeUls: {0}",ulsCategoryStringSetInCshtml),Diag.ULS.sendTraceTag(6160856,TheUlsHost.DefaultCategory(),Diag.ULSTraceLevel.info,"OnLoad"),Diag.ULS.sendTraceTag(6160857,TheUlsHost.DefaultCategory(),Diag.ULSTraceLevel.info,"UserAgent: {0}",window.navigator.userAgent),Diag.ULS.sendTraceTag(6160858,TheUlsHost.DefaultCategory(),Diag.ULSTraceLevel.info,"Detected OS Platform: {0}",GetOSPlatform()),typeof PageLoadTime!="undefined"&&RecordPageLoadTime(),!t}function InstrumentLinks(n){for(var t,r=0,i=0;i<n.length;i++)t=n[i],t.id||(t.id="un_"+r,r++),t.onclick=GenerateInstrumentationLink(t.id,t.onclick),t.ondragstart=GenerateDragInstrumentationLink(t.id,t.ondrag),t.oncontextmenu=GenerateContextMenuInstrumentationLink(t.id,t.oncontextmenu)}function LogUserViewPortInfo(){var t=$(window).width(),n=$(window).height(),i=screen.width,r=screen.height,u=$(document).height(),f=n/u*100;Diag.ULS.sendTraceTag(6436628,TheUlsHost.DefaultCategory(),Diag.ULSTraceLevel.info,"User ViewPort Info;windowWidth={0};windowHeight={1};screenWidth={2};screenHeight={3};percentageOfPageVisible={4};",t,n,i,r,f.toFixed(3))}function UpdateFurthestScrollDepth(){var t=$(window).scrollTop(),i=$(window).height(),r=t+i,u=$(document).height(),n=r/u*100;n>furthestScrollDepthPercentage&&(furthestScrollDepthPercentage=n)}function LogElapsedTimeOnPage(){var n=(new Date).getTime(),t=(n-PageStartLoadTime)/1e3;Diag.ULS.sendTraceTag(6436629,TheUlsHost.DefaultCategory(),Diag.ULSTraceLevel.info,"User time on page ;secondsSpentOnPage={0};",t.toFixed(3))}function InsertAdditionalBeforeUnloadFunction(n){additionalBeforeUnloadFunctions.push(n)}function OnUnloadingPage(){for(var n=0;n<additionalBeforeUnloadFunctions.length;n++)typeof additionalBeforeUnloadFunctions[n]=="function"&&additionalBeforeUnloadFunctions[n]();additionalBeforeUnloadFunctions=[];TheUlsHost&&(Diag.ULS.sendTraceTag(6436630,TheUlsHost.DefaultCategory(),Diag.ULSTraceLevel.info,"The furthest scrollDepth was ;PercentOfPageViewed={0};",furthestScrollDepthPercentage.toFixed(3)),LogElapsedTimeOnPage(),FlushBrowserUls())}function FlushBrowserUls(){var n=TheUlsHost.DefaultCategory();TheUlsHost.dispose();InitializeUls(n)}function FlushUlsAsynchronous(){TheUlsHost&&TheUlsHost.flushAsynchronous()}function GenerateInstrumentationLink(n,t){return function(i){var r="";if(i!=null)switch(i.which){case 1:r="Left";break;case 2:r="Middle";break;case 3:r="Right";break;default:r="Unknown"}return(Diag.ULS.sendTraceTag(6160863,TheUlsHost.DefaultCategory(),Diag.ULSTraceLevel.info,"User clicked on: {0}, ButtonPressed: {1}",n,r),FlushUlsAsynchronous(),t)?t(i):!0}}function GenerateContextMenuInstrumentationLink(n,t){return function(i){return(Diag.ULS.sendTraceTag(6160864,TheUlsHost.DefaultCategory(),Diag.ULSTraceLevel.info,"User right-clicked on: {0}",n),t)?t(i):!0}}function GenerateDragInstrumentationLink(n,t){return function(i){return(Diag.ULS.sendTraceTag(6160865,TheUlsHost.DefaultCategory(),Diag.ULSTraceLevel.info,"User dragged on: {0}",n),t)?t(i):!0}}var Events,OSPlatform,_osPlatform,ClipperIndexURL,NotebooksIndexURL,OrigRefCookieName,OrigRefCookieValue,ShowSignInControl,onSignInDialogKeyUp,Common,__extends,TelemetryClickableClass,Diag,TheUlsHost,furthestScrollDepthPercentage,RecordPageLoadTime,PageStartLoadTime,ulsCategoryStringSetInCshtml,additionalBeforeUnloadFunctions,_onBeforePageUnloadCalled,OneNoteApi,selectedSectionName,SectionPickerState,SectionPicker,AugmentationApi,Utils,clipSectionPicker,Clipper;(function(n){var t;(function(n){var t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it;(function(){})(t=n.Urls||(n.Urls={})),function(n){n.OneNote="OneNote Clipper"}(i=n.ClientIds||(n.ClientIds={})),function(n){var t;(function(n){n.ClipperUseCountOnThisBrowser="clipperUseCountOnThisBrowser"})(t=n.Keys||(n.Keys={}))}(r=n.Cookies||(n.Cookies={})),function(n){n.FeedbackOriginalUrlId="originalUrl";n.AuthQueryParamName="auth";n.AuthQueryParamValueMsa="1";n.AuthQueryParamValueAad="2"}(u=n.QueryParams||(n.QueryParams={})),function(n){n.CorrelationIdHeaderName="X-CorrelationId"}(f=n.Headers||(n.Headers={})),function(n){n.Anchor="a";n.Base="base";n.Br="br";n.Canvas="canvas";n.Div="div";n.IFrame="iframe";n.Image="img";n.Input="input";n.Link="link";n.NoScript="noscript";n.Script="script";n.Span="span";n.Style="style";n.Svg="svg"}(e=n.Tags||(n.Tags={})),function(n){n.AllowTransparency="allowtransparency";n.AutoFocus="autofocus";n.Direction="direction";n.HRef="href";n.Placeholder="placeholder";n.Source="src";n.Scrolling="scrolling";n.Type="type";n.Value="value";n.Name="name";n.Title="title";n.TabIndex="tabindex";n.Target="target"}(o=n.Attributes||(n.Attributes={})),function(n){n.None="none";n.True="true"}(s=n.AttributeValues||(n.AttributeValues={})),function(n){n.Css="oneNoteClipperCss";n.Js="oneNoteClipperJs";n.MainContainerClass="oneNoteClipperWindow";n.SelectedClipOption="selectedClipOption"}(h=n.Classes||(n.Classes={})),function(n){n.FeedbackButton="feedbackButton";n.CloseButton="closeButton";n.LaunchOneNoteButton="launchOneNoteButton";n.SigninButton="signinButton";n.SignoutButton="signoutButton";n.ClipButton="clipButton";n.TryAgainButton="tryAgainButton";n.BackToHomeButton="backToHomeButton";n.RegionClipCancelButton="regionClipCancelButton";n.O365BetaTag="o365BetaTag";n.CurrentUserControl="currentUserControl";n.UserSettingsContainer="userSettingsContainer";n.UserSettingsList="userSettingsList";n.ClipperUIContainer="clipperUIContainer";n.ParentClipperContainer="contentContainer";n.SignInContainer="clipperSignInContainer";n.ClipperContainer="clipperButtonContainer";n.FooterContainer="clipperFooterContainer";n.ApiProgressContainer="clipperApiProgressContainer";n.SuccessContainer="clipperSuccessContainer";n.FailureContainer="clipperFailureContainer";n.CloseButtonContainer="closeButtonContainer";n.RegionClipContainer="clipperRegionClipContainer";n.FullPageButton="fullPageButton";n.RegionModeButton="regionModeButton";n.AugmentationButton="augmentationButton";n.AugmentationButtonImage="augmentationButtonImage";n.AugmentationButtonLabel="augmentationButtonLabel";n.LocationPickerContainer="locationPickerContainer";n.AnnotationContainer="annotationContainer";n.AnnotationField="annotationField";n.AnnotationFieldContainer="annotationFieldContainer";n.AnnotationPlaceholder="annotationPlaceholder";n.ClipperUI="oneNoteClipperUI";n.PreviewUI="oneNoteAugmentedPreviewUI";n.RegionClipUI="oneNoteRegionClipUI";n.PreviewTextContainer="oneNoteAugmentedTextContainer";n.PreviewTitleElement="oneNoteAugmentedTitleContainer";n.PreviewTimestampElement="oneNotePreviewTimestamp";n.PreviewBodyElement="oneNoteAugmentedBodyContainer";n.CheckMarkContainer="checkMarkContainer";n.SpinnerInContainer="spinnerInContainer";n.SpinnerLoopContainer="spinnerLoopContainer";n.SpinnerOutContainer="spinnerOutContainer";n.ApiErrorMessage="apiErrorMessage"}(c=n.IDs||(n.IDs={})),function(n){n.ClipperUIWidth=322;n.ClipperUITopRightOffset=20;n.HorizontalSlidingAnimationBuffer=20;n.ClipperUIDropShadowBuffer=7}(l=n.Styles||(n.Styles={})),function(){}(a=n.Numbers||(n.Numbers={})),function(){}(v=n.Strings||(n.Strings={})),function(){}(y=n.Brs||(n.Brs={})),function(n){n.ClipperInfo="CLIPPER_INFO";n.PageInfo="PAGE_INFO";n.AugmentationApiStatus="AUGMENTATION_API_STATUS";n.AugmentationResponseJson="AUGMENTATION_RESPONSE_JSON"}(p=n.SmartValueKeys||(n.SmartValueKeys={})),function(n){n.CheckForNewerPageInfo="CHECK_FOR_NEWER_PAGE_INFO";n.CheckForNewerPageInfoCallback="CHECK_FOR_NEWER_PAGE_INFO_Callback";n.CloseClipper="CLOSE_CLIPPER";n.CollapseUI="COLLAPSE_UI";n.Dismiss="DISMISS";n.ExpandUI="EXPAND_UI";n.HideAllPreviews="HIDE_PREVIEW";n.RefreshContainerHeight="REFRESH_CONTAINER_HEIGHT";n.RefreshFrameHeight="REFRESH_FRAME_HEIGHT";n.ShowAugmentationPreview="SHOW_AUGMENTATION_PREVIEW";n.Telemetry="TELEMETRY";n.StartRegionMode="START_REGION_MODE";n.SelectionInProgress="SELECTION_IN_PROGRESS";n.RegionSelected="REGION_SELECTED";n.RegionNotSelected="REGION_NOT_SELECTED";n.StartRegionClip="START_REGION_CLIP";n.RegionClipComplete="REGION_CLIP_COMPLETE";n.StopRegionMode="STOP_REGION_MODE";n.TakeTabScreenshot="TAKE_TAB_SCREENSHOT";n.TakeTabScreenshotCallback="TAKE_TAB_SCREENSHOT_CALLBACK"}(w=n.FunctionKeys||(n.FunctionKeys={})),function(n){n.CaptureVisibleTab="captureVisibleTab";n.ExtensionCallbackMessage="ExtensionCallback";n.InvokeClipperCommand="ClipperInvoker";n.Ping="Ping";n.Pong="Pong"}(b=n.ExtensionMessages||(n.ExtensionMessages={})),function(n){n.MainAndExtension="EXTENSION_CHANNEL";n.MainAndUI="MAIN_AND_UI";n.MainAndRegion="MAIN_AND_REGION";n.MainAndPreview="MAIN_AND_PREVIEW"}(k=n.CommunicationChannels||(n.CommunicationChannels={})),function(n){n.RequiredVersionForRegionClipping="2.0.0"}(d=n.VersionNumbers||(n.VersionNumbers={})),function(n){n.WindowsLiveId="WindowsLiveId"}(g=n.AuthTypes||(n.AuthTypes={})),function(n){n[n.Error=0]="Error";n[n.Warning=1]="Warning";n[n.Info=2]="Info";n[n.Verbose=3]="Verbose";n[n.Spam=4]="Spam"}(n.LogLevel||(n.LogLevel={}));nt=n.LogLevel,function(n){n[n.Waiting=0]="Waiting";n[n.Success=1]="Success";n[n.NoContent=2]="NoContent";n[n.Error=3]="Error"}(n.AugmentationApiStatus||(n.AugmentationApiStatus={}));tt=n.AugmentationApiStatus,function(n){n[n.Bookmarklet=0]="Bookmarklet";n[n.ChromeExtension=1]="ChromeExtension";n[n.FirefoxExtension=2]="FirefoxExtension";n[n.SafariExtension=3]="SafariExtension"}(n.ClipperClientType||(n.ClipperClientType={}));it=n.ClipperClientType})(t=n.Constants||(n.Constants={}))})(Clipper||(Clipper={})),function(n){function t(n,t,i){n.addEventListener?n.addEventListener(t,i):n.attachEvent("on"+t,i);r.push({Element:n,Type:t,Listener:i})}function u(n,t,i){n.removeEventListener?n.removeEventListener(t,i):n.detachEvent("on"+t,i)}function o(n,t){var i=document.getElementById(n);i!=null&&e(i,t)}function f(n,t,i){n.style[t]!==i&&(n.style.setProperty?n.style.setProperty(t,i):n.style.setAttribute(t,i))}function e(n,r){t(n,"mousedown",function(){f(n,"outline-style","none")});t(n,"click",r);t(n,"keyup",function(t){document.activeElement===n&&(t.keyCode===i.Enter?(n.tagName==="a"||n.tagName==="A")&&n.hasAttribute("href")||r(t):t.keyCode===i.Tab&&f(n,"outline-style",""))})}function s(n,i,r){var u=document.getElementById(n);u&&t(u,i,r)}function h(n,i){t(window,n,i)}function c(t){n.RegisterWindowEventListener("keyup",function(n){n.keyCode===i.Esc&&t(n)})}function l(){for(var t,n=0;n<r.length;n++)t=r[n],u(t.Element,t.Type,t.Listener)}var i,r;(function(n){n.Tab=9;n.Enter=13;n.Esc=27})(i=n.KeyCode||(n.KeyCode={}));r=[];n.AddEventListener=t;n.RemoveEventListener=u;n.RegisterAccesibleSelectionListener=o;n.RegisterAccesibleSelectionListenerByElement=e;n.RegisterEventListenerById=s;n.RegisterWindowEventListener=h;n.RegisterEscListener=c;n.DismissAllListeners=l}(Events||(Events={})),function(n){(function(n){n[n.OneNoteSite=400]="OneNoteSite";n[n.OneNoteAugmentationProvider_DomEnhancer=411]="OneNoteAugmentationProvider_DomEnhancer";n[n.OneNoteAugmentationProvider_UrlEnhancer=410]="OneNoteAugmentationProvider_UrlEnhancer";n[n.OneNoteAugmentationService_Entitization=412]="OneNoteAugmentationService_Entitization";n[n.OneNoteAugmentationService_BizcardExtractor=415]="OneNoteAugmentationService_BizcardExtractor";n[n.OneNoteAugmentationService=409]="OneNoteAugmentationService";n[n.OneNoteClipperInstall=402]="OneNoteClipperInstall";n[n.OneNoteClipperTooltip=413]="OneNoteClipperTooltip";n[n.OneNoteClipperUsage=403]="OneNoteClipperUsage";n[n.OneNoteUnitTests=401]="OneNoteUnitTests";n[n.OneNoteSiteEmailSettings=404]="OneNoteSiteEmailSettings";n[n.OneNoteSiteFeedbackPage=408]="OneNoteSiteFeedbackPage";n[n.OneNoteSiteNotebooks=405]="OneNoteSiteNotebooks";n[n.OneNoteSiteDevSite=406]="OneNoteSiteDevSite";n[n.OneNoteSiteFeaturedApps=407]="OneNoteSiteFeaturedApps";n[n.OneNoteSiteStudents=414]="OneNoteSiteStudents";n[n.OneNoteNotebookCreator=416]="OneNoteNotebookCreator"})(n.ULSCat||(n.ULSCat={}));var t=n.ULSCat}(Diag||(Diag={})),function(n){function u(n){n===void 0&&(n=document);var t=n.getElementsByTagName("html")[0].getAttribute("lang");return t?t:window.navigator.userLanguage||window.navigator.language}function t(n,t,i){i===void 0&&(i=null);var r=n+"="+t;i&&(r+=";expires="+i.toUTCString());r+=";secure";document.cookie=r}function f(n){t(n,"",new Date("2000-01-01"))}function e(n){var t=document.cookie.match("(^|;) ?"+n+"=([^;]*)(;|$)");return t?t[2]:null}function o(n){return n.preventDefault(),n.stopPropagation(),!1}function s(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=Math.random()*16|0,i=n==="x"?t:t&3|8;return i.toString(16)})}function h(n,t,i){var r=document.createElement("link"),u;r.rel="stylesheet";r.type="text/css";r.href=n;r.className=t;document.head.appendChild(r);i&&(u=new Image,u.onerror=i,u.src=n)}function c(n,t){return window.getComputedStyle?getComputedStyle(n).getPropertyValue(t):n.currentStyle[t]}function l(n,t,i){var u=[t],r;for(t[0]==="-"&&(u=["-ms"+t,"-moz"+t,"-webkit"+t,"-o"+t,t.substr(1)]),r=0;r<u.length;r++)n.style.setProperty?n.style.setProperty(u[r],i):n.style.setAttribute(u[r],i)}function a(n,t,i){var r=n;return r+=-1===r.indexOf("?")?"?":"&",r+(t+"="+i)}function i(n,t,i){var r=new XMLHttpRequest;r.open("GET","https://"+n+"/count/"+t+"?"+i);r.send()}function v(n,t,i){i===void 0&&(i="");var u=r(n,[t]);return u[t]==null||u[t]===""?i:u[t]}function r(n,t){try{var r=new XMLHttpRequest;return r.open("GET","https://"+n+"/Strings?ids="+t.join(),!1),r.send(),JSON.parse(r.responseText)}catch(u){return i(n,"StringsUtil","error="+u),{}}}function y(n){var t=!1;typeof Storage!="undefined"&&(t=localStorage.getItem("EnableConsoleLogging")==="true");t&&console.log(n)}n.GetLocale=u;n.SetCookie=t;n.ExpireCookie=f;n.GetCookie=e;n.DisableClick=o;n.GenerateGuid=s;n.LoadCSS=h;n.GetCssAttribute=c;n.SetCssAttribute=l;n.AddUrlQueryValue=a;n.SendDataToCountEndpoint=i;n.GetLocalizedStringFromServer=v;n.GetLocalizedStringsFromServer=r;n.LogToConsole=y}(Utils||(Utils={}));OSPlatform={IPHONE:"iPhone",IPOD:"iPod",IPAD:"iPad",ANDROID:"Android",WINDOWSPHONE10:"WP10",WINDOWSPHONE8:"WP8",WINDOWSPHONE7:"WP7",WINDOWS10:"Win10",WINDOWS8:"Win8",WINDOWS7:"Win7",WINDOWSVISTAANDBELOW:"WinVistaAndBelow",MAC:"Mac",CHROMEBOOK:"Chromebook",UNSUPPORTED:"unsupported"};_osPlatform=undefined;$(window).on("load",function(){$("a.ChromeDownload").on("click",function(n){var i=$(n.currentTarget),t=i.attr("href");Common.InstallChromeApp(t,NotebooksIndexURL,t,!1)});document.getElementById("h_sign")&&Common.EnableOrigRefCookieSetOnAuth()});(function(n){function i(n,t,i,r){r===void 0&&(r=!1);chrome.webstore&&(Utils.DisableClick(event),Diag.ULS.sendTraceTag(7894217,400,Diag.ULSTraceLevel.info,"Installing Chrome App "+n),chrome.webstore.install(n,function(){Diag.ULS.sendTraceTag(7894218,400,Diag.ULSTraceLevel.info,"Installed "+status);t&&(window.location.href=t)},function(n,t){i&&(r||t!=="launchInProgress"&&t!=="userCancelled"&&t!=="aborted")&&(window.location.href=i);Diag.ULS.sendTraceTag(7894219,400,Diag.ULSTraceLevel.info,"Failure installing "+t)}))}function t(n){n.which===27&&(Utils.SetCookie(OrigRefCookieName,OrigRefCookieValue,new Date("1970-01-01")),onSignInDialogKeyUp(n),$(document).off("keyup",t))}function r(){var n=$("#h_overlay")[0].onclick;$("#h_overlay")[0].onclick=function(){Utils.SetCookie(OrigRefCookieName,OrigRefCookieValue,new Date("1970-01-01"));n(null);$(document).off("keyup",t)};$(document).off("keyup",onSignInDialogKeyUp);$(document).off("keyup",t).keyup(t)}function u(){$("#h_sign")[0].onclick=null;$("#h_sign").click(function(n){$("#h_overlay").is(":visible")?(Utils.SetCookie(OrigRefCookieName,OrigRefCookieValue,new Date("1970-01-01")),ShowSignInControl()):(Utils.SetCookie(OrigRefCookieName,OrigRefCookieValue),ShowSignInControl(),r());GenerateInstrumentationLink("h_sign",null)(n)})}function f(n,t,i){return n+(n.split("?")[1]?"&":"?")+t+"="+i}n.InstallChromeApp=i;n.EnableOrigRefCookieSetOnAuth=u;n.AddParameterToURL=f})(Common||(Common={}));__extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r};TelemetryClickableClass=".onclickable",function(n){var t=function(){function n(){}return n.prototype.isEnabled=function(){var n=!1;return typeof Storage!="undefined"&&(n=localStorage.getItem("EnableConsoleLogging")==="true"),n&&window.console&&window.console.log},n.prototype.error=function(n){window.console.error(n)},n.prototype.warning=function(n){window.console.warn(n)},n.prototype.info=function(n){window.console.info(n)},n.prototype.log=function(n){window.console.log(n)},n}(),i=function(i){function r(r,u,f){u===void 0&&(u=new t);i.call(this,SessionId,"/"+n.UploadingUlsHost.defaultRemoteUlsUrl);this._defaultCategory=r;this._console=u;this._suppressBubbling=f}return __extends(r,i),r.prototype.DefaultCategory=function(){return this._defaultCategory},r.prototype.handleTrace=function(t){if(this._console.isEnabled()){var r="("+t.timestamp+"):\t"+t.message;switch(t.level){case n.ULSTraceLevel.error:this._console.error(r);break;case n.ULSTraceLevel.warning:this._console.warning(r);break;case n.ULSTraceLevel.info:this._console.info(r);break;default:this._console.log(r)}}this._suppressBubbling||i.prototype.handleTrace.call(this,t)},r}(n.UploadingUlsHost);n.ConsoleUlsHost=i}(Diag||(Diag={}));furthestScrollDepthPercentage=0;RecordPageLoadTime=function(){Diag.ULS.sendTraceTag(8206356,TheUlsHost.DefaultCategory(),Diag.ULSTraceLevel.info,"PageLoadTime: {0}",PageLoadTime)};$(window).on("load",function(){InitializeUls(Diag.ULSCat[ulsCategoryStringSetInCshtml]);InstrumentLinks(document.links);InstrumentLinks(document.querySelectorAll(TelemetryClickableClass));LogUserViewPortInfo();UpdateFurthestScrollDepth();PageStartLoadTime=(new Date).getTime()});additionalBeforeUnloadFunctions=[];$(window).on("beforeunload",function(){TheUlsHost&&Diag.ULS.sendTraceTag(6160859,TheUlsHost.DefaultCategory(),Diag.ULSTraceLevel.info,"OnBeforeUnload");OnUnloadingPage();_onBeforePageUnloadCalled=!0});$(window).on("unload",function(){TheUlsHost&&Diag.ULS.sendTraceTag(6160860,TheUlsHost.DefaultCategory(),Diag.ULSTraceLevel.info,"OnUnload");_onBeforePageUnloadCalled||OnUnloadingPage();_onBeforePageUnloadCalled=!1});$(window).on("pageshow",function(){TheUlsHost&&Diag.ULS.sendTraceTag(6160861,TheUlsHost.DefaultCategory(),Diag.ULSTraceLevel.info,"OnPageShow")});$(window).on("pagehide",function(){TheUlsHost&&(Diag.ULS.sendTraceTag(6160862,TheUlsHost.DefaultCategory(),Diag.ULSTraceLevel.info,"OnPageHide"),_onBeforePageUnloadCalled||FlushBrowserUls())});$(window).on("scroll",function(){UpdateFurthestScrollDepth()});(function(n){var t=function(){function n(n,t,i,r,u){r===void 0&&(r=$.ajax);u===void 0&&(u=null);this._appId=n;this._sessionId=t;this._canary=i;this.Handle=r;this._authParamValue=u;this._maxCanaryAttempts=5;this._canaryAttempts=0;this.UseBetaApi=!1}return n.prototype.JqPostSettings=function(n,t,i,r){var u=this.JqGetSettings(n,t);return u.type="POST",u.data=i,u.contentType=r,u},n.prototype.JqGetSettings=function(t,i,r){var u=this,o,f,s,e;return r===void 0&&(r=!1),o=this.GenerateFormHeaders(i),r?f=t:(s=this.UseBetaApi?"/api/beta/me/notes":"/api/v1.0/me/notes",f=s+t),this._authParamValue&&this._authParamValue!==""&&(f=Common.AddParameterToURL(f,"auth",this._authParamValue)),e={url:f,type:"GET",dataType:"json",processData:!1,timeout:i.timeout||6e4,success:i.success,error:function(t,r,f){if(t.status===n._httpResponseCodeForNewCanary)if(u._canaryAttempts>=u._maxCanaryAttempts)Diag.ULS.sendTraceTag(7882003,403,Diag.ULSTraceLevel.info,"Number of canary retries exceeded. {0}",JSON.stringify(e.headers));else{u._canaryAttempts++;e.headers["X-Key"]=t.getResponseHeader("X-NewKey");u.Handle(e);return}i.error(t,r,f);u._canaryAttempts=0},headers:o}},n.prototype.GetAuthParamValue=function(){return this._authParamValue?this._authParamValue:""},n.prototype.UpdateAuthParamValue=function(n){this._authParamValue=n},n.prototype.UpdateCanary=function(n){this._canary=n},n.prototype.UpdateSessionId=function(n){this._sessionId=n},n.prototype.GenerateFormHeaders=function(n){var t={"X-Key":this._canary,"MS-Int-AppID":this._appId},i;if(this._sessionId&&(t["X-UserSessionId"]=this._sessionId),t["X-CorrelationId"]=Utils.GenerateGuid(),n.headerOverrides)for(i in n.headerOverrides)n.headerOverrides.hasOwnProperty(i)&&(t[i]=n.headerOverrides[i]);return t},n._httpResponseCodeForNewCanary=412,n}();n.OneNoteApiBase=t})(OneNoteApi||(OneNoteApi={})),function(n){(function(n){n[n.Html=0]="Html";n[n.Image=1]="Image";n[n.EnhancedUrl=2]="EnhancedUrl";n[n.Url=3]="Url";n[n.Onml=4]="Onml"})(n.ClipTypes||(n.ClipTypes={}));var t=n.ClipTypes}(OneNoteApi||(OneNoteApi={})),function(n){var t=function(){function n(){this.contentTypeMultipart="multipart/form-data; boundary=";this.parts=[];this.boundaryName="OneNoteTypedDataBoundary"+Math.floor(Math.random()*1e3)}return n.prototype.GetContentType=function(){return this.contentTypeMultipart+this.boundaryName},n.prototype.Append=function(n,t,i){this.parts.push({name:n,content:t,type:i})},n.prototype.GetData=function(){for(var t,r="--"+this.boundaryName,n=r,i=0;i<this.parts.length;i++)t=this.parts[i],n+="\r\n",n+="Content-Type: "+t.type+"\r\n",n+="Content-Disposition: form-data; name="+t.name+"\r\n\r\n",n+=t.content+"\r\n",n+=r;return n+"--\r\n"},n}();n.TypedFormData=t}(OneNoteApi||(OneNoteApi={})),function(n){var t=function(){function t(n,t,i,r){var u,f,e;if(n===void 0&&(n=""),t===void 0&&(t=""),i===void 0&&(i="en-us"),r===void 0&&(r=null),this._body=t,this._locale=i,this._pageMetadata=r,this._htmlParts=[],u="",r!=null)for(f in r)u+='<meta name="'+f+'" content="'+$("<div/>").text(r[f]).html()+'" />';e=this.FormUtcOffsetString(new Date);n=$("<div/>").text(n).html();this._body='<html xmlns="http://www.w3.org/1999/xhtml" lang='+i+"><head><title>"+n+'<\/title><meta name="created" content="'+e+' ">'+u+"<\/head><body>"+t}return t.prototype.AddHtml=function(n,t){return this.AddAttachment(0,n,t)},t.prototype.AddImage=function(n){return this.AddAttachment(1,null,n)},t.prototype.AddEnhancedUrl=function(n){return this.AddAttachment(2,null,n)},t.prototype.AddUrl=function(n){return this.AddAttachment(3,null,n)},t.prototype.AddAnnotation=function(n){return this.AddOnml(n)},t.prototype.AddCitation=function(n,t,i){return this.AddOnml(n.replace("{0}",'<a href="'+(i?i:t)+'">'+t+"<\/a>"))},t.prototype.AddAttachment=function(n,t,i){var r="",u;switch(n){case 0:u="Attachment"+Math.floor(Math.random()*1e4).toString();this._htmlParts.push({name:u,content:t,type:"text/HTML"});i&&(r='<div data-render-src="'+i+'" data-render-method="extract" data-render-fallback="none"><\/div>');r+='<img data-render-src="name:'+u+'"/>';break;case 3:r='<div data-render-src="'+i+'" data-render-method="extract" data-render-fallback="none"><\/div>';case 2:r+='<img data-render-src="'+i+'"/>';break;case 1:r='<img src="'+i+'"/>';break;case 4:r=t}return this.AddOnml(r),this},t.prototype.AddOnml=function(n){return this._body+=n,this},t.prototype.GetTypedFormData=function(){var r=new n.TypedFormData,t,i;for(r.Append("Presentation",this._body+"<\/body><\/html>","application/xhtml+xml"),t=0;t<this._htmlParts.length;t++)i=this._htmlParts[t],r.Append(i.name,i.content,i.type);return r},t.prototype.FormUtcOffsetString=function(n){var t=n.getTimezoneOffset(),u=t>=0?"-":"+",i,r;return t=Math.abs(t),i=Math.floor(t/60)+"",r=Math.round(t%60)+"",parseInt(i)<10&&(i="0"+i),parseInt(r)<10&&(r="0"+r),u+i+":"+r},t}();n.OneNotePage=t}(OneNoteApi||(OneNoteApi={})),function(n){var t=function(n){function t(t,i,r,u,f){u===void 0&&(u=$.ajax);f===void 0&&(f=null);n.call(this,t,i,r,u,f)}return __extends(t,n),t.prototype.CopyNotebook=function(n,t){var i=this.JqPostSettings("/notebooks/"+t+"/Microsoft.OneNote.Api.CopyNotebook/",n,null,"application/json");Diag.ULS.sendTraceTag(8699934,400,Diag.ULSTraceLevel.info,"Call to copy notebook. additional headers: {0}",JSON.stringify(i.headers));this.Handle(i)},t.prototype.CopyNotebookProgress=function(n,t){var i=this.JqGetSettings(t,n,!0);Diag.ULS.sendTraceTag(8976350,400,Diag.ULSTraceLevel.info,"Call to get copy notebook's progress. additional headers: {0}",JSON.stringify(i.headers));this.Handle(i)},t.prototype.CreateNotebook=function(n,t){var r=JSON.stringify({name:t}),i=this.JqPostSettings(this.GetNotebooksUrl(),n,r,"application/json");Diag.ULS.sendTraceTag(7127193,403,Diag.ULSTraceLevel.info,"Call to create notebook. additional headers: {0}",JSON.stringify(i.headers));this.Handle(i)},t.prototype.CreatePage=function(n,t,i){var f=i?"/sections/"+i:"",e=f+"/pages",r=t.GetTypedFormData(),u=this.JqPostSettings(e,n,r.GetData(),r.GetContentType());Diag.ULS.sendTraceTag(6160850,403,Diag.ULSTraceLevel.info,"API call additional headers: {0}",JSON.stringify(u.headers));this.Handle(u)},t.prototype.CreateSection=function(n,t,i){var u={name:i},f=JSON.stringify(u),r=this.JqPostSettings("/notebooks/"+t+"/sections/",n,f,"application/json");Diag.ULS.sendTraceTag(7439815,403,Diag.ULSTraceLevel.info,"Call to create section. additional headers: {0}",JSON.stringify(r.headers));this.Handle(r)},t.prototype.GetNotebooks=function(n,t){t===void 0&&(t=2);var i=this.JqGetSettings(this.GetNotebooksUrl(t),n);Diag.ULS.sendTraceTag(6308418,403,Diag.ULSTraceLevel.info,"Call to get notebooks. additional headers: {0}",JSON.stringify(i.headers));this.Handle(i)},t.prototype.GetNotebookByName=function(n,t){var i=this.JqGetSettings("/notebooks?filter=name%20eq%20%27"+encodeURI(t)+"%27&orderby=createdTime",n);Diag.ULS.sendTraceTag(8741011,403,Diag.ULSTraceLevel.info,"Call to get notebook by name. additional headers: {0}",JSON.stringify(i.headers));this.Handle(i)},t.prototype.PagesSearch=function(n,t){var i=this.JqGetSettings(this.GetSearchUrl(t),n);this.Handle(i)},t.prototype.GetExpands=function(n){if(n<=0)return"";var t="$expand=sections,sectionGroups";return n===1?t:t+"("+this.GetExpands(n-1)+")"},t.prototype.GetNotebooksUrl=function(n){n===void 0&&(n=0);return"/notebooks?$filter=userRole%20ne%20Microsoft.OneNote.Api.UserRole'Reader'"+(n?"&"+this.GetExpands(n):"")},t.prototype.GetSearchUrl=function(n){return"/pages?search="+n},t}(n.OneNoteApiBase);n.OneNoteApi=t}(OneNoteApi||(OneNoteApi={})),function(n){var t=function(){function n(n,t){this.ErrorMessage=n;this.TreatAsAce=t}return n}();n.ResponseCodeInformation=t}(OneNoteApi||(OneNoteApi={})),function(n){n[n.Empty=0]="Empty";n[n.Error=1]="Error";n[n.Loading=2]="Loading";n[n.Notebooks=3]="Notebooks"}(SectionPickerState||(SectionPickerState={}));SectionPicker=function(){function n(t,i,r){var f=this,u,e;if(this._sectionPickerContainerId="sectionPickerContainer",this._isSectionPickerRtl=!1,this._tabIndex=50,!n.ClipperImageClusterUrl)throw"Image cluster url not set";if(!n.LoadingImageUrl)throw"Loading image url not set";if(!n.GetDataErrorMessage)throw"Get data error message not set";if(!t)throw"Invalid containerElementId";if(u=document.getElementById(t),!u)throw"Unable to get the container element";if(!i)throw"Invalid location picker refresh callback";if(!r)throw"Invalid API";if(($("body").css("direction")==="rtl"||$("body").hasClass("DirectionRtl"))&&(this._isSectionPickerRtl=!0,n.EntityExpandImageClassName+=" ElementDirectionMirror",n.NotebookImageClassName+=" ElementDirectionMirror",n.SectionGroupImageClassName+=" ElementDirectionMirror"),this._api=r,this.LocationPickerUiRefreshCallback=i,n.LastSelectedSection=null,n.UserDefaultSectionId="-1",n.LastSelectedSectionId=n.LastSelectedSectionId!==""?n.LastSelectedSectionId:Utils.GetCookie("lastSelectedSectionId"),n.LastSelectedNotebookId=n.LastSelectedNotebookId!==""?n.LastSelectedNotebookId:Utils.GetCookie("lastSelectedNotebookId"),e=Utils.GetCookie("lastSelectedSectionName"),this.SetSectionLocationName(e?e:defaultLocationString),$("#sectionPickerContainer").empty(),this.SectionPickerElement=document.createElement("ul"),this.SectionPickerElement.className=n.SectionPickerElementClassName,u.appendChild(this.SectionPickerElement),this.LoadingElement=document.createElement("img"),this.LoadingElement.src=n.LoadingImageUrl,this.LoadingElement.className=n.LoadingElementClassName,u.appendChild(this.LoadingElement),this.ErrorElement=document.createElement("label"),$(this.ErrorElement).text(n.GetDataErrorMessage),this.ErrorElement.className=n.ErrorMessageElementClassName,u.appendChild(this.ErrorElement),!n._externalEventsCreated){Events.RegisterAccesibleSelectionListener("SectionLocationContainer",function(t){var r=$("."+n.SectionPickerPopupClassName),i;r.toggle();i=$("#SaveToLocationContainer");r.css("top",i.offset().top+i.height()+2);r.css("left",i.offset().left);r.css("width",i.width());$(".SelectedSection").length>0&&$("#"+f._sectionPickerContainerId).scrollTop(document.getElementsByClassName("SelectedSection")[0].offsetTop-$("#sectionPickerContainer").height()+$(".SelectedSection").height());t.stopPropagation();f.LocationPickerUiRefreshCallback()});$(window).on("click",function(){$("."+n.SectionPickerPopupClassName).is(":visible")&&($("."+n.SectionPickerPopupClassName).hide(),f.LocationPickerUiRefreshCallback())});$(".SectionPickerPopup").click(function(n){n.stopPropagation()});n._externalEventsCreated=!0}this.SetState(0)}return n.prototype.GetData=function(){var n=this;this.SetState(2);this._apiCallStartTime=new Date;Diag.ULS.sendTraceTag(6308419,403,Diag.ULSTraceLevel.info,"SectionPicker.GetData executing GetNotebooks request");this._api.GetNotebooks({success:function(t,i,r){n.OnGetDataSuccess(t,i,r)},error:function(t,i,r){n.OnGetDataFailure(t,i,r)},timeout:null},sectionPickerNumberOfExpandsInGetNotebooksCall)},n.prototype.GetMaxUserNotebookDepth=function(n){for(var r,u,t=0,i=0;i<n.length;i++)r=n[i],u=this.GetNotebookDepth(r),t=Math.max(t,u);return t},n.prototype.GetNotebookDepth=function(n){return typeof n.sectionGroups=="undefined"||!n.sectionGroups.length?typeof n.sections!="undefined"?n.sections.length?1:0:0:this.GetSectionGroupsDepth(n.sectionGroups)},n.prototype.GetSectionGroupsDepth=function(n){for(var r,u,t=0,i=0;i<n.length;i++)r=n[i],u=this.GetSectionGroupDepth(r),t=Math.max(t,u);return t},n.prototype.GetSectionGroupDepth=function(n){var t=n.sectionGroups,i=n.sections;return typeof t=="undefined"&&typeof i=="undefined"?1:t.length?1+this.GetSectionGroupsDepth(t):i.length?2:1},n.prototype.OnGetDataSuccess=function(n,t,i){var e=new Date,r=e.getTime()-this._apiCallStartTime.getTime();Diag.ULS.sendTraceTag(6308420,403,Diag.ULSTraceLevel.info,"SectionPicker.GetData succeeded. API CorrelationId: {0}, textStatus: {1}, duration: {2}",i.getResponseHeader("X-CorrelationId"),t,r);var u=n.value,f=this.GetMaxUserNotebookDepth(u),o=f>=sectionPickerNumberOfExpandsInGetNotebooksCall;Diag.ULS.sendTraceTag(9319326,403,Diag.ULSTraceLevel.info,"SectionPicker.GetData Notebook Depth Stats. MaxUserNotebookDepth: {0}, BrsDepth: {1}, MaxedBrs: {2}, Duration: {3}",f,sectionPickerNumberOfExpandsInGetNotebooksCall,o,r);this.ProcessNotebooks(u);this.SetState(3)},n.prototype.OnGetDataFailure=function(n,t,i){var e=new Date,o=e.getTime()-this._apiCallStartTime.getTime(),u=0,f=!0,r=JSON.parse(n.responseText);r&&r.error&&typeof HandledExtendedResponseCodes[r.error.code]!="undefined"&&(u=r.error.code,f=HandledExtendedResponseCodes[u].TreatAsAce);Diag.ULS.sendTraceTag(6308421,403,Diag.ULSTraceLevel.error,"SectionPicker.GetData failed. API CorrelationId: {0}, textStatus: {1}, extendedErrorCode: {2}, treatAsAce: {3}, duration: {4}, errorThrown: {5}",n.getResponseHeader("X-CorrelationId"),t,u,f,o,i);this.SetState(1)},n.prototype.ProcessNotebooks=function(n){var t,i,r;if(n)for(t=0;t<n.length;t++)i=n[t],r=this.CreateNotebookElement(i,t),this.SectionPickerElement.appendChild(r.rootElement),this.ProcessSections(i.sections,r.childContainer),this.ProcessSectionGroups(i.sectionGroups,r.childContainer)},n.prototype.ProcessSectionGroups=function(n,t){var i,r,u;if(!t)throw"Section group parent container invalid";if(n)for(i=0;i<n.length;i++)r=n[i],u=this.CreateSectionGroupElement(r),t.appendChild(u.rootElement),this.ProcessSections(r.sections,u.childContainer),this.ProcessSectionGroups(r.sectionGroups,u.childContainer)},n.prototype.ProcessSections=function(n,t){var i,r,u;if(!t)throw"Section parent container invalid";if(n)for(i=0;i<n.length;i++)r=n[i],u=this.CreateSectionElement(r),t.appendChild(u)},n.prototype.CreateNotebookElement=function(t){return t?this.CreateContainerElement(t.id,t.name,n.NotebookRootElementClassName,n.ClosedClassName,n.NotebookImageContainerClassName,n.NotebookImageClassName,n.NotebookImageSrcName):null},n.prototype.CreateSectionGroupElement=function(t){var r,i;if(!t)return null;if(r=n.ClosedClassName,t.sections)for(i=0;i<t.sections.length;i++)t.sections[i].id===n.LastSelectedSectionId&&(r=n.OpenedClassName);return this.CreateContainerElement(t.id,t.name,n.SectionGroupElementClassName,r,n.SectionGroupImageContainerClassName,n.SectionGroupImageClassName,n.SectionGroupImageSrcName)},n.prototype.CreateSectionElement=function(t){var r=this,i;return t?(t.isDefault&&(n.UserDefaultSectionId=t.id.toString()),t.id===n.LastSelectedSectionId&&(n.LastSelectedSection=t),i=this.CreateRootElement(t.id,t.name,n.SectionElementClassName,n.ClosedClassName,n.SectionImageContainerClassName,n.SectionImageClassName,n.SectionImageSrcName),Events.RegisterAccesibleSelectionListenerByElement(i,function(u){u.stopPropagation();n.LastSelectedSection=t;n.LastSelectedSectionId=t.id;r.OnSectionClick(i)}),i):null},n.prototype.ToggleOpenedClosedState=function(t){t&&(t.className.indexOf(n.ClosedClassName)>-1?t.className=t.className.replace(n.ClosedClassName,n.OpenedClassName):t.className.indexOf(n.OpenedClassName)>-1&&(t.className=t.className.replace(n.OpenedClassName,n.ClosedClassName)))},n.prototype.OnSectionClick=function(t){var i,r,u;Diag.ULS.sendTraceTag(7456899,403,Diag.ULSTraceLevel.info,"SectionPicker.OnSectionClick called. User selected a location.");$("#"+this._sectionPickerContainerId).find(".SelectedSection").removeClass("SelectedSection");i=this.GetSelectedSectionName(t);Utils.SetCookie("lastSelectedSectionName",i,new Date("9999-12-12"));Utils.SetCookie("lastSelectedSectionId",n.LastSelectedSection.id,new Date("9999-12-12"));t.className+=" SelectedSection";n.SelectedSectionIsInitialSelected=i===this._initialSelectedSectionName;this.SetSectionLocationName(i);$(".SectionPickerPopup").hide();r=$("li."+n.NotebookRootElementClassName);r.removeClass(n.ClosedClassName);r.addClass(n.ClosedClassName);r.removeClass(n.OpenedClassName);$(t).parents("."+n.NotebookRootElementClassName).length>0&&(u=$(t).parents("."+n.NotebookRootElementClassName)[0].getAttribute("id"),document.getElementById(u).className=n.NotebookRootElementClassName+" "+n.OpenedClassName,n.LastSelectedNotebookId=u,Utils.SetCookie("lastSelectedNotebookId",u,new Date("9999-12-12")));this.LocationPickerUiRefreshCallback()},n.prototype.GetSelectedSectionName=function(n){var f=$(n).parents(".Notebook")[0],t,r,i,u;for(selectedSectionName=$($(f).find(".EntityName")[0]).text(),t=" > ",this._isSectionPickerRtl&&(t=" < "),r=$(n).parents(".SectionGroup").get().reverse(),i=0;i<r.length;i++)u=$($(r[i]).find(".EntityName")[0]).text(),selectedSectionName=this._isSectionPickerRtl?u+t+selectedSectionName:selectedSectionName+t+u;return selectedSectionName=this._isSectionPickerRtl?$(n).text()+t+selectedSectionName:selectedSectionName+t+$(n).text()},n.prototype.ShowDefaultLocation=function(){var i,t,u,f,r,e;if(this._initialSelectedSectionName=defaultLocationString,i=n.UserDefaultSectionId,n.LastSelectedSection!=null?i=n.LastSelectedSection.id.toString():(n.LastSelectedSectionId="",n.LastSelectedNotebookId="",Utils.ExpireCookie("lastSelectedSectionName"),Utils.ExpireCookie("lastSelectedSectionId")),i!=="-1"&&(t=document.getElementById(i),t)){if(this._initialSelectedSectionName=this.GetSelectedSectionName(t),u=$(t).parents("."+n.NotebookRootElementClassName)[0].getAttribute("id"),n.LastSelectedNotebookId=u,document.getElementById(u).className=n.NotebookRootElementClassName+" "+n.OpenedClassName,f=$(t).parents("."+n.SectionGroupElementClassName).length,f>0)for(r=0;r<f;r++)e=$(t).parents("."+n.SectionGroupElementClassName)[r].getAttribute("id"),document.getElementById(e).className=n.SectionGroupElementClassName+" "+n.OpenedClassName;t.className=n.SectionElementClassName+" SelectedSection"}this.SetSectionLocationName(this._initialSelectedSectionName)},n.prototype.SetSectionLocationName=function(n){var t=$(".SectionLocation");t.text(n);t.attr({title:n})},n.prototype.CreateContainerElement=function(n,t,i,r,u,f,e){var h=this,o=this.CreateRootElement(n,t,i,r,u,f,e),s;return Events.RegisterAccesibleSelectionListenerByElement(o,function(n){n.stopPropagation();h.ToggleOpenedClosedState(o)}),s=document.createElement("ul"),o.appendChild(s),{rootElement:o,childContainer:s}},n.prototype.CreateRootElement=function(t,i,r,u,f,e,o){var h=document.createElement("li"),s,c,v,y,p,l,a;return h.className=r+" "+u,h.id=t,h.tabIndex=this._tabIndex++,s=document.createElement("div"),s.className=n.EntityImageAndNameContainerClassName,t===n.LastSelectedSectionId&&($(".SelectedSection").removeClass("SelectedSection"),s.className+=" SelectedSection"),h.appendChild(s),c=document.createElement("div"),c.className=n.EntityExpandCollapseContainer,s.appendChild(c),v=n.CreateImage(n.EntityExpandImageContainerClassName,n.EntityExpandImageClassName,n.EntityExpandImageSrcName),c.appendChild(v),r!==n.SectionElementClassName&&(y=n.CreateImage(n.EntityCollapseImageContainerClassName,n.EntityCollapseImageClassName,n.EntityCollapseImageSrcName),c.appendChild(y)),p=n.CreateImage(f,e,o),s.appendChild(p),l=document.createElement("div"),l.className="EntityNameContainer",s.appendChild(l),a=document.createElement("label"),a.className=n.EntityNameClassName,$(a).text(i),l.appendChild(a),h},n.CreateImage=function(t,i,r){var f=document.createElement("div"),u;return f.className=t,u=document.createElement("img"),u.className=i,u.src=n.ClipperImageClusterUrl+r,f.appendChild(u),f},n.prototype.SetState=function(n){Diag.ULS.sendTraceTag(6308422,403,Diag.ULSTraceLevel.info,"SectionPicker.setState setting state {0}",n.toString());$(".SectionPickerState").hide();var t;switch(n){case 0:return;case 2:t=this.LoadingElement;break;case 3:t=this.SectionPickerElement;this.ShowDefaultLocation();break;case 1:default:Diag.ULS.sendTraceTag(6308423,403,Diag.ULSTraceLevel.info,"SectionPicker.setState entering error state");t=this.ErrorElement}$(t).show()},n.ClipperImageClusterUrl=clipperImageClusterUrlSetInCshtml,n.LoadingImageUrl=loadingImageUrlSetInCshtml,n.GetDataErrorMessage=getDataErrorMessageSetInCshtml,n.SectionPickerElementClassName="SectionPickerState SectionPicker",n.LoadingElementClassName="SectionPickerState SectionPickerLoading",n.ErrorMessageElementClassName="SectionPickerState SectionPickerError",n.NotebookRootElementClassName="Notebook",n.SectionGroupElementClassName="SectionGroup",n.SectionElementClassName="Section",n.SectionPickerPopupClassName="SectionPickerPopup",n.EntityImageAndNameContainerClassName="EntityImageAndNameContainer",n.EntityExpandCollapseContainer="ExpandCollapseContainer",n.EntityNameClassName="EntityName",n.EntityExpandImageContainerClassName="Expand",n.EntityExpandImageClassName="ExpandImage",n.EntityExpandImageSrcName="Arrow-Right.png",n.EntityCollapseImageContainerClassName="Collapse",n.EntityCollapseImageClassName="CollapseImage",n.EntityCollapseImageSrcName="Arrow-Down.png",n.NotebookImageContainerClassName="EntityImage",n.NotebookImageClassName="NotebookImage",n.NotebookImageSrcName="Notebook.png",n.SectionGroupImageContainerClassName="EntityImage",n.SectionGroupImageClassName="SectionGroupImage",n.SectionGroupImageSrcName="GroupSection.png",n.SectionImageContainerClassName="EntityImage",n.SectionImageClassName="SectionImage",n.SectionImageSrcName="Section.png",n.OpenedClassName="Opened",n.ClosedClassName="Closed",n.UserDefaultSectionId="-1",n.LastSelectedSection=null,n.LastSelectedSectionId="",n.LastSelectedNotebookId="",n.SelectedSectionIsInitialSelected=!0,n._externalEventsCreated=!1,n}(),function(n){var t=function(){function n(){}return n.prototype.Augment=function(n,t,i,r){if(!t||t.length===0)throw"DOM parameter is null or empty";if(!i||i.length===0)throw"URL parameter is null or empty";if(!r||r.length===0)throw"sessionId parameter is null or empty";var u={"X-UserSessionId":r};$.ajax({url:"/onaugmentation/extract/v1.0/?renderMethod=extractAggressive&url="+i,type:"POST",contentType:"text/html",dataType:"json",data:t,success:n.success,error:n.error,headers:u})},n}();n.AugmentationApi=t}(AugmentationApi||(AugmentationApi={})),function(n){var t=function(){function n(n){n===void 0&&(n=null);this._t=null;this._subscriptions=[];this._t=n}return n.prototype.Subscribe=function(n){this._subscriptions.push(n);n(this._t)},n.prototype.Set=function(n){if(this._t!==n){this._t=n;for(var t=0;t<this._subscriptions.length;t++)this._subscriptions[t](this._t)}},n.prototype.Get=function(){return this._t},n.prototype.Equals=function(n){return this._t===n},n.prototype.ToString=function(){return this._t==null?"null":this._t.toString()},n.Subscribe=function(n,t){for(var i=0;i<n.length;i++)n[i].Subscribe(function(){for(var r=[],i=0;i<n.length;i++)r.push(n[i].Get());t.apply(this,r)})},n}();n.SmartValue=t}(Utils||(Utils={})),function(n){var t=function(){function n(n,t){var i=this;this._otherSideInitialized=!1;this._otherSideKeys=[];this._thisSideKeys=[];this._queuedCalls={};this._functionMap={};this._registrationKey="REGISTER-FUNCTION-234234f24";this._initializationKey="INIT-3n083nk6";this._setValuePrefix="SETVALUE-";this.handleMessage=function(n){var t,u,f,r,e,o;try{t=JSON.parse(n.data)}catch(s){return}if(t.commId!==i._myUniqueCommId&&(!i._channel||t.channel&&t.channel===i._channel)&&(i._channel||t.channel==null)){if(t.functionKey===i._registrationKey){if(u=t.data.toString(),i._otherSideKeys.push(u),i.OnNewFunctionAvailable(u),i._queuedCalls[u])for(f=i._queuedCalls[u],r=0;r<f.length;r++)i.PostMessage(f[r])}else if(t.functionKey===i._initializationKey)for(i._otherSideInitialized=!0,t.data&&i.SendInitializationMessage(!1),r=0;r<i._thisSideKeys.length;r++)i.PostMessage({functionKey:i._registrationKey,data:i._thisSideKeys[r]});else e=i._functionMap[t.functionKey],e&&(o=e(t.data),t.callbackKey&&i.CallRemoteFunction(t.callbackKey,o));n.stopPropagation?n.stopPropagation():n.cancelBubble=!0}};this._getOtherWindow=n;this._channel=t;this._myUniqueCommId=this.CreateUniqueId();Events.RegisterWindowEventListener("message",this.handleMessage);this.SendInitializationMessage(!0)}return n.prototype.SendInitializationMessage=function(n){this.PostMessage({functionKey:this._initializationKey,data:n})},n.prototype.RegisterFunction=function(n,t){this._functionMap[n]=t;this._otherSideInitialized&&this.PostMessage({functionKey:this._registrationKey,data:n});this._thisSideKeys.push(n)},n.prototype.CallRemoteFunction=function(n,t,i){var r={functionKey:n,data:t};i&&(r.callbackKey=i);this._otherSideKeys.indexOf(n)>=0?this.PostMessage(r):(this._queuedCalls[n]=this._queuedCalls[n]||[],this._queuedCalls[n].push(r))},n.prototype.SubscribeAcrossCommunicator=function(n,t){this.RegisterFunction(this._setValuePrefix+t,function(t){n.Set(t)})},n.prototype.BroadcastAcrossCommunicator=function(n,t){var i=this;n.Subscribe(function(n){i.CallRemoteFunction(i._setValuePrefix+t,n)})},n.prototype.OnNewFunctionAvailable=function(){},n.prototype.Dismiss=function(){Events.RemoveEventListener(window,"message",this.handleMessage)},n.prototype.PostMessage=function(n){this._channel&&(n.channel=this._channel);n.commId=this._myUniqueCommId;this._getOtherWindow().postMessage(JSON.stringify(n),"*")},n.prototype.CreateUniqueId=function(){for(var r,t="",n=Date.now(),i=0;i<16;i++)r=(n+Math.random()*16)%16|0,t+=r.toString(16),n=Math.floor(n/16);return t},n}();n.Communicator=t}(Utils||(Utils={})),function(n){var t=function(){function n(n,t){this.SmartValue=n;typeof t=="function"?(this._useConditional=!0,this._conditional=t):(this._useConditional=!1,this._expectedValue=t)}return n.prototype.IsTrue=function(){return this._useConditional?this._conditional(this.SmartValue.Get()):this.SmartValue.Equals(this._expectedValue)},n.Lock=function(n,t,i){var u,f,r;for(i===void 0&&(i=!1),u=!1,f=[],r=0;r<n.length;r++)f.push(n[r].SmartValue);Utils.SmartValue.Subscribe(f,function(){var r,f;if(!u){for(r=!0,f=0;f<n.length;f++)r=r&&n[f].IsTrue();r&&(t(),u=!i)}})},n}(),i,r;n.Condition=t;i=function(n){function t(t){n.call(this,t,function(n){return n!=null})}return __extends(t,n),t}(t);n.IsNotNullCondition=i;r=function(n){function t(t){n.call(this,t,function(n){return n})}return __extends(t,n),t}(t);n.IsTrueCondition=r}(Clipper||(Clipper={})),function(n){var t;(function(n){function i(n,t){var i=n.className.split(" ");return i.indexOf(t)>=0}function t(n){for(var r,u=this.getElementsByTagName("*"),f=[],t=0;t<u.length;t++)r=u[t],i(r,n)&&f.push(r);return f}function r(n){for(var t=0;t<this.length;t++)if(this[t]===n)return t;return-1}function u(n){setTimeout(function(){n(Date.now())},16)}function f(){var n,i;if(typeof JSON=="undefined"||!JSON.parse||!JSON.stringify||JSON.stringify([])==='"[]"'&&(delete Array.prototype.toJSON,JSON.stringify([])==='"[]"'))return!1;if(typeof Element!="undefined")Element.prototype?Element.prototype.getElementsByClassName||(Element.prototype.getElementsByClassName=t):HTMLElement&&HTMLElement.prototype&&(HTMLElement.prototype.getElementsByClassName||(HTMLElement.prototype.getElementsByClassName=t)),HTMLAnchorElement&&!HTMLAnchorElement.prototype.getElementsByClassName&&(HTMLAnchorElement.prototype.getElementsByClassName=t),document.getElementsByClassName||(document.getElementsByClassName=t);else return!1;return Array.prototype.indexOf||(Array.prototype.indexOf=r),document.head||(n=document.getElementsByTagName("head"),n.length===0&&(i=document.createElement("head"),document.body.parentNode.appendChild(i)),document.head=document.getElementsByTagName("head")[0]),document.body.tagName.toLowerCase()!=="body"&&(document.body.appendChild=function(n){return document.body.parentElement.appendChild(n)}),window.requestAnimationFrame||(window.requestAnimationFrame=window.msRequestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.oRequestAnimationFrame||u),Array.prototype.forEach||(Array.prototype.forEach=function(n,t){for(var r=this.length,i=0;i<r;i++)i in this&&n.call(t,this[i],i,this)}),!0}n.Init=f})(t=n.Polyfills||(n.Polyfills={}))}(Clipper||(Clipper={})),function(n){var t=function(n){function t(t,i){var r=this;n.call(this);Utils.SmartValue.Subscribe(t,function(){for(var f,u=[],n=0;n<t.length;n++)u.push(t[n].Get());f=i.apply(null,u);r.Set(f,!0)})}return __extends(t,n),t.prototype.Set=function(t,i){i===void 0&&(i=!1);i&&n.prototype.Set.call(this,t)},t}(Utils.SmartValue);n.DependentValue=t}(Clipper||(Clipper={})),function(n){function t(n){var t=n.split("."),i=parseInt(t[0])||0,r=parseInt(t[1])||0,u=parseInt(t[2])||0;return{Major:i,Minor:r,Build:u}}function r(n,r){if(n==null||r==null)throw"Values can't be null";return i(t(n),t(r))}function i(n,t){if(n==null||t==null)throw"Values can't be null";return n.Major>t.Major?-1:n.Major<t.Major?1:n.Minor>t.Minor?-1:n.Minor<t.Minor?1:n.Build>t.Build?-1:n.Build<t.Build?1:0}n.ParseVersion=t;n.CompareVersionStr=r;n.CompareVersions=i}(Clipper||(Clipper={})),function(n){var t;(function(n){var t;(function(n){var t=function(){function n(n,t,i,r,u,f){u===void 0&&(u=!1);f===void 0&&(f=24);this._element=n;this._element.style.backgroundImage="url("+t+")";this._element.style.backgroundRepeat="no-repeat";this._element.style.height=i+"px";this._imageHeight=i;this._totalFrameCount=r;this._inProgress=!1;this._loop=u;this._fps=f}return n.prototype.Start=function(){var n=this;this._inProgress=!0;this._currentFrame=0;this._currentTime=this.RightNow();requestAnimationFrame(function(){return n.UpdateToNextFrame()})},n.prototype.Stop=function(){this._inProgress=!1},n.prototype.InProgress=function(){return this._inProgress},n.prototype.OnFinishLoop=function(){},n.prototype.UpdateToNextFrame=function(){var r=this,t=this.RightNow(),i,n;this._inProgress&&(i=(t-this._currentTime)/1e3,this._currentFrame+=i*this._fps,n=Math.floor(this._currentFrame),n>=this._totalFrameCount&&(this.OnFinishLoop(),this._loop?n=this._currentFrame=0:(this.Stop(),n=this._currentFrame=this._totalFrameCount-1)),this._element.style.backgroundPosition="0 -"+n*this._imageHeight+"px",this._currentTime=t,requestAnimationFrame(function(){return r.UpdateToNextFrame()}))},n.prototype.RightNow=function(){return window.performance&&window.performance.now?window.performance.now():Date.now()},n}();n.ImageSequencer=t})(t=n.Animations||(n.Animations={}))})(t=n.UI||(n.UI={}))}(Clipper||(Clipper={})),function(n){var t,r,u,i;(function(n){n[n.SignInNeeded=0]="SignInNeeded";n[n.ClipOptions=1]="ClipOptions";n[n.ClippingToApi=2]="ClippingToApi";n[n.ClippingFailed=3]="ClippingFailed";n[n.ClippingSucceeded=4]="ClippingSucceeded";n[n.RegionClipping=5]="RegionClipping"})(n.UIState||(n.UIState={}));t=n.UIState,function(n){n[n.None=0]="None";n[n.InProgress=1]="InProgress";n[n.Succeeded=2]="Succeeded";n[n.Failed=3]="Failed"}(n.ApiCallState||(n.ApiCallState={}));r=n.ApiCallState,function(n){n[n.None=0]="None";n[n.RegionClip=1]="RegionClip"}(n.ClipSelectionMode||(n.ClipSelectionMode={}));u=n.ClipSelectionMode;i=function(){function i(t){var i=this,r;this._expandInProgress=!1;this.InitializeElementHandles();this.InitializeImageAnimations();this.HideAllElements();this.UserSignedIn=new Utils.SmartValue(IsUserAuthenticated);Diag.ULS.sendTraceTag(7398220,403,Diag.ULSTraceLevel.info,"userAlreadySignedInOnUiInit: {0}",IsUserAuthenticated);this.ApiCall=new Utils.SmartValue(0);this.SelectionMode=new Utils.SmartValue(0);this._communicator=t;r=new n.DependentValue([this.UserSignedIn,this.ApiCall,this.SelectionMode],function(){return i.GetState()});r.Subscribe(function(n){i.UpdateUIForState(n)});this.ExpandAnimation()}return i.prototype.GetState=function(){if(!this.UserSignedIn.Get())return 0;if(this.SelectionMode.Get()===1)return 5;switch(this.ApiCall.Get()){case 1:return 2;case 2:return 4;case 3:return 3;case 0:default:return 1}},i.prototype.UpdateUIForState=function(n){var i,r;switch(n){case 0:i=[this._clipperContainer,this._apiProgressContainer,this._failureContainer,this._regionClipContainer,this._successContainer,this._footerContainer,this._signoutButton];r=[this._signInContainer,this._closeButtonContainer];break;case 2:i=[this._signInContainer,this._clipperContainer,this._failureContainer,this._regionClipContainer,this._successContainer,this._closeButtonContainer,this._footerContainer,this._signoutButton];r=[this._apiProgressContainer];break;case 3:i=[this._signInContainer,this._clipperContainer,this._apiProgressContainer,this._regionClipContainer,this._successContainer];r=[this._failureContainer,this._closeButtonContainer,this._footerContainer,this._signoutButton];break;case 4:i=[this._signInContainer,this._clipperContainer,this._apiProgressContainer,this._failureContainer,this._regionClipContainer];r=[this._successContainer,this._closeButtonContainer,this._footerContainer,this._signoutButton];break;case 5:i=[this._signInContainer,this._clipperContainer,this._apiProgressContainer,this._failureContainer,this._successContainer,this._footerContainer,this._signoutButton];r=[this._regionClipContainer,this._closeButtonContainer];break;case 1:default:i=[this._signInContainer,this._apiProgressContainer,this._failureContainer,this._regionClipContainer,this._successContainer];r=[this._clipperContainer,this._closeButtonContainer,this._footerContainer,this._signoutButton]}Diag.ULS.sendTraceTag(7632089,403,Diag.ULSTraceLevel.info,"Clipper UI State Change: {0}",t[n]);this.ExecuteStateTransition(i,r)},i.prototype.ResizeClipperFrame=function(t){var u=450,r,i;t||(t={duration:u,easing:"easeOutQuart"});r=this.CalculateVisibleContainerHeight();this._expandInProgress||this._animationContainer.stop(!0,!0).animate({height:r},t);i=r;i+=n.Constants.Styles.ClipperUIDropShadowBuffer*2;this._sectionPickerPopup.css("display")!=="none"&&this._sectionPickerPopup.length>0&&(i+=this._sectionPickerPopup.height());this._communicator!=null&&this._communicator.CallRemoteFunction(n.Constants.FunctionKeys.RefreshContainerHeight,{newHeight:i,animationTime:u})},i.prototype.CalculateVisibleContainerHeight=function(){var n=100,t=this._animationContainer.clone().css({height:"auto"}).appendTo("body"),i=t.innerHeight();return t.remove(),i<n?n:i},i.prototype.ExecuteStateTransition=function(n,t){var i=this;n.forEach(function(n){n.stop(!0,!0)});t.forEach(function(n){n.stop(!0,!0)});this.EndStateImageAnimations(n,function(){i.AnimateElementsOut(n,function(){i.StartStateImageAnimations(t);i.AnimateElementsIn(t);i.ResizeClipperFrame()})})},i.prototype.EndStateImageAnimations=function(n,t){var i=this,r=!1;this._apiProgressContainer.is(":visible")&&$.inArray(this._apiProgressContainer,n)!==-1&&this._spinnerLoopAnimation.InProgress()&&(r=!0,this._spinnerLoopAnimation.OnFinishLoop=function(){i._spinnerInContainer.hide();i._spinnerLoopContainer.hide();i._spinnerOutContainer.show();i._spinnerLoopAnimation.OnFinishLoop=function(){};i._spinnerLoopAnimation.Stop();i._spinnerOutAnimation.Start();i._spinnerOutAnimation.OnFinishLoop=function(){t&&t()}});t&&!r&&t()},i.prototype.StartStateImageAnimations=function(n){var t=this;this._apiProgressContainer.is(":hidden")&&$.inArray(this._apiProgressContainer,n)!==-1&&(this._spinnerInContainer.show(),this._spinnerLoopContainer.hide(),this._spinnerOutContainer.hide(),this._spinnerInAnimation.Start(),this._spinnerInAnimation.OnFinishLoop=function(){t._spinnerInContainer.hide();t._spinnerLoopContainer.show();t._spinnerOutContainer.hide();t._spinnerLoopAnimation.Start()});this._successContainer.is(":hidden")&&$.inArray(this._successContainer,n)!==-1&&this._checkMarkAnimation.Start()},i.prototype.AnimateElementsOut=function(n,t){var i=0,r=200;n.forEach(function(n){n.is(":visible")&&(i++,n.animate({opacity:0,left:20},{queue:!1,duration:r,easing:"easeInOutQuad",complete:function(){i--;n.hide();i===0&&t()}}))});i===0&&t()},i.prototype.AnimateElementsIn=function(n){var t=400,i=this._expandInProgress?20:-20;n.forEach(function(n){n.is(":hidden")&&(n.css({opacity:0,left:i}),n.show(),n.animate({opacity:1,left:0},{queue:!1,duration:t,easing:"easeInOutQuad"}))})},i.prototype.ExpandAnimation=function(){var i=this,t,e;this._expandInProgress=!0;this.UpdateUIForState(this.GetState());var r=n.Constants.Styles.ClipperUIDropShadowBuffer,u=n.Constants.Styles.ClipperUIWidth,f=this.CalculateVisibleContainerHeight();this._animationContainer.stop(!0);this._animationContainer.css({left:r+u+n.Constants.Styles.HorizontalSlidingAnimationBuffer,width:0,opacity:0,height:f/2});t=500;e=10;this._animationContainer.animate({left:r,width:u,opacity:1},{queue:!1,duration:t,easing:"easeOutExpo"});this._animationContainer.delay(e).animate({height:f},{duration:t,easing:"easeOutQuad",complete:function(){i._expandInProgress=!1;i.ResizeClipperFrame()}})},i.prototype.CollapseAnimation=function(){var n=400,t=this._animationContainer.parent().width();this._animationContainer.stop(!0);this._animationContainer.animate({left:t,width:0,height:this._animationContainer.height()/2,opacity:0},{duration:n,easing:"easeInOutQuad"});this.HideAllElements(n/2)},i.prototype.InitializeElementHandles=function(){this._animationContainer=$("#"+n.Constants.IDs.ClipperUIContainer);this._parentDivContainer=$("#"+n.Constants.IDs.ParentClipperContainer);this._sectionPickerPopup=$("."+SectionPicker.SectionPickerPopupClassName);this._clipperContainer=$("#"+n.Constants.IDs.ClipperContainer);this._apiProgressContainer=$("#"+n.Constants.IDs.ApiProgressContainer);this._failureContainer=$("#"+n.Constants.IDs.FailureContainer);this._regionClipContainer=$("#"+n.Constants.IDs.RegionClipContainer);this._successContainer=$("#"+n.Constants.IDs.SuccessContainer);this._footerContainer=$("#"+n.Constants.IDs.FooterContainer);this._signoutButton=$("#"+n.Constants.IDs.SignoutButton);this._signInContainer=$("#"+n.Constants.IDs.SignInContainer);this._closeButtonContainer=$("#"+n.Constants.IDs.CloseButtonContainer);this._spinnerInContainer=$("#"+n.Constants.IDs.SpinnerInContainer);this._spinnerLoopContainer=$("#"+n.Constants.IDs.SpinnerLoopContainer);this._spinnerOutContainer=$("#"+n.Constants.IDs.SpinnerOutContainer)},i.prototype.InitializeImageAnimations=function(){var f=document.getElementById(n.Constants.IDs.CheckMarkContainer),t,i,r,u;this._checkMarkAnimation=new n.UI.Animations.ImageSequencer(f,n.Constants.Urls.CheckMarkIn,28,30);t=32;i=32;this._spinnerInAnimation=new n.UI.Animations.ImageSequencer(this._spinnerInContainer[0],n.Constants.Urls.SpinnerIn,t,i);r=21;this._spinnerLoopAnimation=new n.UI.Animations.ImageSequencer(this._spinnerLoopContainer[0],n.Constants.Urls.SpinnerLoop,t,r,!0);u=28;this._spinnerOutAnimation=new n.UI.Animations.ImageSequencer(this._spinnerOutContainer[0],n.Constants.Urls.SpinnerOut,t,u)},i.prototype.HideAllElements=function(n){n===void 0&&(n=0);var t=[this._clipperContainer,this._apiProgressContainer,this._failureContainer,this._regionClipContainer,this._successContainer,this._footerContainer,this._signoutButton,this._signInContainer,this._closeButtonContainer,this._sectionPickerPopup];t.forEach(function(t){t.fadeOut(n)})},i}();n.UIStateMachine=i}(Clipper||(Clipper={})),function(n){var t,i;(function(n){n[n.FullPage=0]="FullPage";n[n.Augmentation=1]="Augmentation";n[n.Region=2]="Region"})(t||(t={}));i=function(){function i(){var t=this;this._oneNoteApi=new OneNoteApi.OneNoteApi(n.Constants.ClientIds.OneNote,SessionId,ApiCanary);this._communicator=new Utils.Communicator(function(){return parent},n.Constants.CommunicationChannels.MainAndUI);this._stateMachine=new n.UIStateMachine(this._communicator);this._defaultClipMode=DefaultToAugmentedButton?1:0;this._clipMode=new Utils.SmartValue(this._defaultClipMode);this._signInAttemptCount=0;this._oneNoteApiCallCount=1;this.InitializeTelemetry();this.UpdateClipperUsageCookie();this.RegisterButtonHandlers();this.InitializeCommunicationListeners();n.Condition.Lock([new n.IsNotNullCondition(this._clipperInfo)],function(){var n=t._clipperInfo.Get();Diag.ULS.sendTraceTag(7682132,403,Diag.ULSTraceLevel.info,"Clipper info received. ClipperId: {0}, ClipperType: {1}, ClipperVersion: {2}",n.ClipperId,n.ClipperType,n.ClipperVersion);t.InitializeRegionClippingIfEnabled()});this._clipMode.Subscribe(function(){t.ClipModeChanged()});this.CalculatePageLoadTime()}return i.prototype.InitializeCommunicationListeners=function(){var t=this,i;this._clipperInfo=new Utils.SmartValue(null);this._communicator.SubscribeAcrossCommunicator(this._clipperInfo,n.Constants.SmartValueKeys.ClipperInfo);this._pageInfo=new Utils.SmartValue(null);this._communicator.SubscribeAcrossCommunicator(this._pageInfo,n.Constants.SmartValueKeys.PageInfo);i=!1;this._pageInfo.Subscribe(function(n){if(n!==null)if(i){var r=Utils.GenerateGuid();Diag.ULS.sendTraceTag(8192908,403,Diag.ULSTraceLevel.info,"Switching SessionIds. oldSessionId: {0}, newSessionId: {1}",SessionId,r);t._oneNoteApi.UpdateSessionId(r);SessionId=r;FlushBrowserUls()}else i=!0});this._stateMachine.UserSignedIn.Subscribe(function(i){i?(Diag.ULS.sendTraceTag(7742675,403,Diag.ULSTraceLevel.info,"User is signed in. AuthType: {0}",UserType),UserType===n.Constants.AuthTypes.WindowsLiveId?(t._oneNoteApi.UpdateAuthParamValue(n.Constants.QueryParams.AuthQueryParamValueMsa),$("#"+n.Constants.IDs.O365BetaTag).hide()):(t._oneNoteApi.UpdateAuthParamValue(n.Constants.QueryParams.AuthQueryParamValueAad),$("#"+n.Constants.IDs.O365BetaTag).show()),ClipperOrgIdEnabled&&($("#"+n.Constants.IDs.UserSettingsContainer).hide(),$("#currentUserName").text(UserName),$("#currentUserId").text(UserId)),LocationPickerEnabled?t.SetupLocationPicker():($("#"+n.Constants.IDs.LocationPickerContainer).hide(),t._stateMachine.ResizeClipperFrame()),t.ClipModeChanged()):(Utils.ExpireCookie("lastSelectedSectionName"),Utils.ExpireCookie("lastSelectedSectionId"),t._clipMode.Set(t._defaultClipMode),t._communicator.CallRemoteFunction(n.Constants.FunctionKeys.HideAllPreviews),t._stateMachine.ApiCall.Set(0),t.ResetAnnotation(),$("#"+n.Constants.IDs.UserSettingsContainer).hide())});AugmentationEnabled&&(this.InitializeAugmentationFeatures(),n.Condition.Lock([new n.IsNotNullCondition(this._pageInfo),new n.IsTrueCondition(this._stateMachine.UserSignedIn)],function(){t.StartAugmentationDetection()},!0));this._communicator.RegisterFunction(n.Constants.FunctionKeys.ExpandUI,function(){t._stateMachine.ApiCall.Set(0);t._stateMachine.SelectionMode.Set(0);t.ResetAnnotation();$("#"+n.Constants.IDs.UserSettingsContainer).hide();t.ClipModeChanged();t._stateMachine.ExpandAnimation()});this._communicator.RegisterFunction(n.Constants.FunctionKeys.CollapseUI,function(){t._stateMachine.CollapseAnimation()});this._communicator.RegisterFunction(n.Constants.FunctionKeys.CheckForNewerPageInfoCallback,function(){t.SaveDataToOneNote(1,t._pageInfo.Get())})},i.prototype.InitializeRegionClippingIfEnabled=function(){var t=this;RegionClipEnabled&&n.Constants.ClipperClientType[this._clipperInfo.Get().ClipperType]!==0&&n.CompareVersionStr(n.Constants.VersionNumbers.RequiredVersionForRegionClipping,this._clipperInfo.Get().ClipperVersion)>=0&&($("#"+n.Constants.IDs.RegionModeButton).show(),this._communicator.RegisterFunction(n.Constants.FunctionKeys.RegionSelected,function(){jQuery.fx.off=!0;t._stateMachine.SelectionMode.Set(0);jQuery.fx.off=!1}),this._communicator.RegisterFunction(n.Constants.FunctionKeys.RegionNotSelected,function(){jQuery.fx.off=!0;t._stateMachine.SelectionMode.Set(1);jQuery.fx.off=!1}),this._communicator.RegisterFunction(n.Constants.FunctionKeys.RegionClipComplete,function(n){t.SaveDataToOneNote(4,t._pageInfo.Get(),n)}))},i.prototype.UpdateClipperUsageCookie=function(){var i=+Utils.GetCookie(n.Constants.Cookies.Keys.ClipperUseCountOnThisBrowser),t=isNaN(i)?0:i+1;return Utils.SetCookie(n.Constants.Cookies.Keys.ClipperUseCountOnThisBrowser,t+"",new Date("9999-12-12")),Diag.ULS.sendTraceTag(7420120,403,Diag.ULSTraceLevel.info,"clipperUsesOnThisBrowser: {0}",t),t},i.prototype.CalculatePageLoadTime=function(){var n=(new Date).getTime();PageLoadTime=n-performance.timing.navigationStart;RecordPageLoadTime()},i.prototype.InitializeTelemetry=function(){InitializeUls(403);InstrumentLinks($("a"));var t={};t[2]=Diag.ULSTraceLevel.info;t[1]=Diag.ULSTraceLevel.warning;t[0]=Diag.ULSTraceLevel.error;this._communicator.RegisterFunction(n.Constants.FunctionKeys.Telemetry,function(n){Diag.ULS.sendTraceTag(3683868,403,t[n.Level],JSON.stringify(n.Log))})},i.prototype.ResetAnnotation=function(){document.getElementById(n.Constants.IDs.AnnotationContainer)&&($("#"+n.Constants.IDs.AnnotationPlaceholder).show(),$("#"+n.Constants.IDs.AnnotationFieldContainer).hide(),$("#"+n.Constants.IDs.AnnotationField).val(""),this._stateMachine.ResizeClipperFrame())},i.prototype.ExpandAnnotation=function(){var r;if(document.getElementById(n.Constants.IDs.AnnotationContainer)){Diag.ULS.sendTraceTag(8193439,403,Diag.ULSTraceLevel.info,"User expanded the annotation field");var t=$("#"+n.Constants.IDs.AnnotationField),u=$("#"+n.Constants.IDs.AnnotationPlaceholder),f=$("#"+n.Constants.IDs.AnnotationFieldContainer),i={duration:300,easing:"easeOutBack"};t.stop(!0,!0);u.hide();f.show();t.focus();this._stateMachine.ResizeClipperFrame(i);r=t.outerHeight();t.height(0);t.animate({height:r},i)}},i.prototype.RegisterButtonHandlers=function(){var t=this;Events.RegisterAccesibleSelectionListener(n.Constants.IDs.SigninButton,function(){t.CheckIfUserIsAuthenticated(function(n){n||t.PopupSignInWindow()})});Events.RegisterAccesibleSelectionListener(n.Constants.IDs.CurrentUserControl,function(){var i=$("#"+n.Constants.IDs.UserSettingsContainer);i.is(":visible")?i.hide():(t.PopulateUserList(),i.show());t._stateMachine.ResizeClipperFrame()});Events.RegisterAccesibleSelectionListener(n.Constants.IDs.SignoutButton,function(){t.SignOut()});Events.RegisterAccesibleSelectionListener(n.Constants.IDs.FullPageButton,function(){t._clipMode.Set(0)});Events.RegisterAccesibleSelectionListener(n.Constants.IDs.AugmentationButton,function(){t._clipMode.Set(1)});Events.RegisterAccesibleSelectionListener(n.Constants.IDs.RegionModeButton,function(){t._clipMode.Set(2)});Events.RegisterAccesibleSelectionListener(n.Constants.IDs.RegionClipCancelButton,function(){t._stateMachine.SelectionMode.Set(0);t._clipMode.Set(t._defaultClipMode)});Events.RegisterAccesibleSelectionListener(n.Constants.IDs.ClipButton,function(){t._disableClipButton&&t._disableClipButton.Get()||(t.StartClip(),t._communicator.CallRemoteFunction(n.Constants.FunctionKeys.HideAllPreviews))});Events.RegisterAccesibleSelectionListener(n.Constants.IDs.AnnotationPlaceholder,function(){t.ExpandAnnotation()});Events.RegisterEventListenerById(n.Constants.IDs.AnnotationField,"blur",function(){$.trim($("#"+n.Constants.IDs.AnnotationField).val())===""&&t.ResetAnnotation()});Events.RegisterAccesibleSelectionListener(n.Constants.IDs.TryAgainButton,function(){t.StartClip()});Events.RegisterAccesibleSelectionListener(n.Constants.IDs.BackToHomeButton,function(){t._stateMachine.ApiCall.Set(0);t._stateMachine.SelectionMode.Set(0);$("#"+n.Constants.IDs.UserSettingsContainer).hide();t._clipMode.Get()===2&&t._clipMode.Set(t._defaultClipMode);t.ClipModeChanged()});Events.RegisterAccesibleSelectionListener(n.Constants.IDs.FeedbackButton,function(){var i=1e3,r=700,u=screen.width?(screen.width-i)/2:0,f=screen.height?(screen.height-r)/2:0,e="height="+r+",width="+i+",top="+f+",left="+u+",scrollbars=yes,resizable=yes,location=no,menubar=no,status=yes,titlebar=no,toolbar=no",o=Utils.AddUrlQueryValue(ClipperFeedbackUrl,n.Constants.QueryParams.FeedbackOriginalUrlId,t._pageInfo.Get().CanonicalUrl);window.open(o,"_blank",e)});Events.RegisterAccesibleSelectionListener(n.Constants.IDs.CloseButton,function(){t._communicator.CallRemoteFunction(n.Constants.FunctionKeys.CloseClipper)});Events.RegisterEscListener(function(){t._communicator.CallRemoteFunction(n.Constants.FunctionKeys.CloseClipper)})},i.prototype.PopupSignInWindow=function(){var r=this;this._signInAttemptCount++;Diag.ULS.sendTraceTag(7456900,403,Diag.ULSTraceLevel.info,"User has started a sign-in attempt. attempt: {0}",this._signInAttemptCount);var n=1e3,t=700,u=screen.width?(screen.width-n)/2:0,f=screen.height?(screen.height-t)/2:0,e="height="+t+",width="+n+",top="+f+",left="+u+",scrollbars=yes,resizable=yes,location=no,menubar=no,status=yes,titlebar=no,toolbar=no",o=ClipperSignInUrl,i=window.open(o,"_blank",e),s=setInterval(function(){(i==null||i.closed)&&(clearInterval(s),r.CheckIfUserIsAuthenticated())},100)},i.prototype.PopulateUserList=function(){var h=this,r=$("#"+n.Constants.IDs.UserSettingsContainer),s,u,t,f,e,o,i;for(r.empty(),s=200,u=[{id:UserId,name:UserName,type:UserType}],t=0;t<u.length;t++)f="userAction"+t,e=$("<a/>",{id:f,"class":"userActionButton",text:n.Constants.Strings.SignOutAction,tabindex:s++}),InstrumentLinks(e),o=$("<div/>",{"class":"userDetails confineText"}),o.append($("<label/>",{text:u[t].id})),i=$("<div/>"),i.append(e),i.append(o),r.append($("<hr/>",{"class":"userDivider"})),r.append(i),Events.RegisterAccesibleSelectionListener(f,function(){h.SignOut()})},i.prototype.SignOut=function(){var n=document.createElement("iframe");n.hidden=!0;n.style.display="none";n.src=ClipperSignOutUrl;document.body.appendChild(n);Diag.ULS.sendTraceTag(7397712,403,Diag.ULSTraceLevel.info,"Session ended by sign-out action.");this._stateMachine.UserSignedIn.Set(!1);this._signInAttemptCount=0},i.prototype.CheckIfUserIsAuthenticated=function(t){var i=this;$.ajaxSetup({cache:!1});$.ajax({url:n.Constants.Urls.Auth,dataType:"json",async:!1,success:function(n){Diag.ULS.sendTraceTag(7456901,403,Diag.ULSTraceLevel.info,"User has ended a sign-in attempt. attempt: {0}, success: {1}",i._signInAttemptCount,n.isUserSignedIn);n.isUserSignedIn&&(i._oneNoteApi.UpdateCanary(n.canary),UserName=n.userName,UserId=n.userId,UserType=n.userType,i._stateMachine.UserSignedIn.Set(!0));t&&t(n.isUserSignedIn)}})},i.prototype.ClipModeChanged=function(){this._communicator.CallRemoteFunction(n.Constants.FunctionKeys.HideAllPreviews);var t;switch(this._clipMode.Get()){default:case 0:t=n.Constants.IDs.FullPageButton;break;case 1:t=n.Constants.IDs.AugmentationButton;this._stateMachine.UserSignedIn.Get()&&this._communicator.CallRemoteFunction(n.Constants.FunctionKeys.ShowAugmentationPreview);break;case 2:t=n.Constants.IDs.RegionModeButton;this._stateMachine.SelectionMode.Set(1);this._communicator.CallRemoteFunction(n.Constants.FunctionKeys.StartRegionMode)}$("#"+n.Constants.IDs.FullPageButton).removeClass(n.Constants.Classes.SelectedClipOption);$("#"+n.Constants.IDs.AugmentationButton).removeClass(n.Constants.Classes.SelectedClipOption);$("#"+n.Constants.IDs.RegionModeButton).removeClass(n.Constants.Classes.SelectedClipOption);$("#"+t).addClass(n.Constants.Classes.SelectedClipOption)},i.prototype.StartClip=function(){Diag.ULS.sendTraceTag(7397711,403,Diag.ULSTraceLevel.info,"Clip started. mode: {0}, attempt: {1}, domLength: {2}, contentLocale: {3}, url: {4}",t[this._clipMode.Get()],this._oneNoteApiCallCount,this._pageInfo.Get().ContentData.length,this._pageInfo.Get().ContentLocale,this._pageInfo.Get().CanonicalUrl);switch(this._clipMode.Get()){default:case 0:this._communicator.CallRemoteFunction(n.Constants.FunctionKeys.CheckForNewerPageInfo);break;case 1:this.SaveDataToOneNote(4,this._pageInfo.Get(),this._augmentationReplyJson.Get().ContentInHtml,this._augmentationReplyJson.Get().PageMetadata);break;case 2:this._communicator.CallRemoteFunction(n.Constants.FunctionKeys.StartRegionClip)}},i.prototype.SaveDataToOneNote=function(n,t,i,r){var u,f,e;i===void 0&&(i="");r===void 0&&(r=null);u="";LocationPickerEnabled&&SectionPicker.LastSelectedSectionId!==""&&(u=SectionPicker.LastSelectedSectionId,f=!1,SectionPicker.LastSelectedSection!=null&&(f=SectionPicker.LastSelectedSection.isDefault),Diag.ULS.sendTraceTag(7456902,403,Diag.ULSTraceLevel.info,"SectionPicker info. defaultSection: {0}, initialSelectedSection: {1}, attempt: {2}",f,SectionPicker.SelectedSectionIsInitialSelected,this._oneNoteApiCallCount));e={clipType:n,onmlData:i,sectionId:u,pageInfo:t,pageMetadata:r};this.CallOneNoteApi(e)},i.prototype.CallOneNoteApi=function(i){var e=this,r=new OneNoteApi.OneNotePage(i.pageInfo.ContentTitle,"",i.pageInfo.ContentLocale,i.pageMetadata),u,f,o;document.getElementById(n.Constants.IDs.AnnotationContainer)&&(u=$("#"+n.Constants.IDs.AnnotationField).val(),f=u!=="",f&&(o=$("<div/>").text(u).html(),r.AddAnnotation(o)),Diag.ULS.sendTraceTag(8193440,403,Diag.ULSTraceLevel.info,"User is clipping, annotationExists: {0}",f));switch(i.clipType){case 4:r.AddOnml(i.onmlData);break;case 1:i.pageInfo.ContentType===2?r.AddAttachment(i.pageInfo.ContentType,i.pageInfo.ContentData,i.pageInfo.RawUrl):r.AddAttachment(i.pageInfo.ContentType,i.pageInfo.ContentData);break;default:throw"Incorrect usage: CallApi only supports Onml and Image parameters.";}r.AddCitation(LocStringCitation,i.pageInfo.CanonicalUrl,i.pageInfo.RawUrl);this._stateMachine.ApiCall.Set(1);this._oneNoteApiCallCount===1&&Diag.ULS.sendTraceTag(7608397,403,Diag.ULSTraceLevel.info,"User attempted clip for the first time this session");this._loggedClipType=t[this._clipMode.Get()];this._clipMode.Get()===1&&(this._loggedClipType=this._augmentationMode);Diag.ULS.sendTraceTag(7608398,403,Diag.ULSTraceLevel.info,"API CreatePage call started. clipType: {0}, attempt: {1}",OneNoteApi.ClipTypes[i.clipType],this._oneNoteApiCallCount);this._oneNoteApiCallStartTime=new Date;this._oneNoteApi.CreatePage({success:function(n,t,r){return e.HandleOneNoteApiSuccess(i,n,t,r)},error:function(n,t,r){return e.HandleOneNoteApiFailure(i,n,t,r)},timeout:ApiTimeout,headerOverrides:{"X-SourceUrl":i.pageInfo.CanonicalUrl}},r,i.sectionId)},i.prototype.HandleOneNoteApiSuccess=function(t,i,r,u){var f=new Date,e=f.getTime()-this._oneNoteApiCallStartTime.getTime();Diag.ULS.sendTraceTag(3731846,403,Diag.ULSTraceLevel.info,"API call returns success. API correlationId: {0}, textStatus: {1}, duration: {2}, clipType: {3}, attempt: {4}",u.getResponseHeader(n.Constants.Headers.CorrelationIdHeaderName),r,e,this._loggedClipType,this._oneNoteApiCallCount);this._stateMachine.ApiCall.Set(2);i&&i.links&&i.links.oneNoteWebUrl&&i.links.oneNoteWebUrl.href?document.getElementById(n.Constants.IDs.LaunchOneNoteButton).setAttribute("href",i.links.oneNoteWebUrl.href):Diag.ULS.sendTraceTag(7639758,403,Diag.ULSTraceLevel.error,"API call returns success but no view in OneNote link returned as expected");this._oneNoteApiCallCount++},i.prototype.HandleOneNoteApiFailure=function(t,i,r,u){var c=new Date,f=c.getTime()-this._oneNoteApiCallStartTime.getTime(),h;if(i.status!==0){var e=0,s=!0,o=JSON.parse(i.responseText);o&&o.error&&typeof HandledExtendedResponseCodes[o.error.code]!="undefined"&&(e=o.error.code,h=HandledExtendedResponseCodes[e].ErrorMessage,h&&(s=HandledExtendedResponseCodes[e].TreatAsAce,$("#"+n.Constants.IDs.ApiErrorMessage).text(h),s?($("#"+n.Constants.IDs.TryAgainButton).hide(),$("#"+n.Constants.IDs.BackToHomeButton).show()):($("#"+n.Constants.IDs.TryAgainButton).show(),$("#"+n.Constants.IDs.BackToHomeButton).hide())));Diag.ULS.sendTraceTag(8786455,403,Diag.ULSTraceLevel.error,"API call returned a failure. API correlationId: {0}, httpStatusCode: {1}, extendedErrorCode: {2}, treatAsAce: {3}, textStatus: {4}, duration: {5}, clipType: {6}, attempt: {7}",i.getResponseHeader(n.Constants.Headers.CorrelationIdHeaderName),i.status,e,s,u,f,this._loggedClipType,this._oneNoteApiCallCount);Diag.ULS.sendTraceTag(3731847,403,Diag.ULSTraceLevel.error,"API call returns failure. API correlationId: {0}, error thrown: {1}, textStatus: {2}, duration: {3}, clipType: {4}, attempt: {5}",i.getResponseHeader(n.Constants.Headers.CorrelationIdHeaderName),u,i.status,f,this._loggedClipType,this._oneNoteApiCallCount)}else r==="timeout"?Diag.ULS.sendTraceTag(6912071,403,Diag.ULSTraceLevel.warning,"API call timed out. API correlationId: {0}, error thrown: {1}, textStatus: {2}, duration: {3}, clipType: {4}, attempt: {5}",i.getResponseHeader(n.Constants.Headers.CorrelationIdHeaderName),u,i.status,f,this._loggedClipType,this._oneNoteApiCallCount):Diag.ULS.sendTraceTag(6912072,403,Diag.ULSTraceLevel.info,"User navigated away. API correlationId: {0}, error thrown: {1}, textStatus: {2}, duration: {3}, clipType: {4}, attempt: {5}",i.getResponseHeader(n.Constants.Headers.CorrelationIdHeaderName),u,i.status,f,this._loggedClipType,this._oneNoteApiCallCount);this._stateMachine.ApiCall.Set(3);this._oneNoteApiCallCount++},i.prototype.InitializeAugmentationFeatures=function(){var t=this;this._augmentationApiStatus=new Utils.SmartValue(0);this._disableClipButton=new n.DependentValue([this._augmentationApiStatus,this._clipMode],function(i,r){var u=r===1&&i!==1;return u&&t._disableClipButton!=null&&!t._disableClipButton.Get()?$("#"+n.Constants.IDs.ClipButton).addClass("disabled"):!u&&t._disableClipButton!=null&&t._disableClipButton.Get()&&$("#"+n.Constants.IDs.ClipButton).removeClass("disabled"),u});this._communicator.BroadcastAcrossCommunicator(this._augmentationApiStatus,n.Constants.SmartValueKeys.AugmentationApiStatus);this._augmentationReplyJson=new Utils.SmartValue(null);this._communicator.BroadcastAcrossCommunicator(this._augmentationReplyJson,n.Constants.SmartValueKeys.AugmentationResponseJson);this.UpdateAugmentationButtonForContentModel(ContentModels.Article);$("#"+n.Constants.IDs.AugmentationButton).show()},i.prototype.StartAugmentationDetection=function(){var t=this,i;this._augmentationApiStatus.Set(0);i=new AugmentationApi.AugmentationApi;this._augmentationApiCallStartTime=new Date;i.Augment({success:function(n,i,r){return t.HandleAugmentationApiSuccess(n,i,r)},error:function(n,i,r){return t.HandleAugmentationApiFailure(n,i,r)}},this._pageInfo.Get().ContentData,this._pageInfo.Get().CanonicalUrl,SessionId);this.UpdateAugmentationButtonForContentModel(ContentModels.Article);$("#"+n.Constants.IDs.AugmentationButton).show()},i.prototype.UpdateAugmentationButtonForContentModel=function(t){var i=EnumToLocalizedStrings[t],e=EnumToButtonImgUris[t];if(!i||!e)return!1;var r=$("#"+n.Constants.IDs.AugmentationButton),u=$("#"+n.Constants.IDs.AugmentationButtonLabel),f=$("#"+n.Constants.IDs.AugmentationButtonImage);return i!==u.text()&&(u.text()===""?(u.text(i),f.attr("src",e),f.attr("alt",i)):r.fadeOut(400,function(){u.text(i);f.attr("src",e);f.attr("alt",i);r.css({opacity:0,left:"120px",position:"relative"});r.show();r.animate({opacity:1,left:0},{duration:400,easing:"easeOutExpo"})})),!0},i.prototype.HandleAugmentationApiSuccess=function(n,t){var e=new Date,r=e.getTime()-this._augmentationApiCallStartTime.getTime(),i,f,u;n&&n.length>=1?(n[0].ContentInHtml=this.RemoveSvgs(n[0].ContentInHtml),this._augmentationReplyJson.Set(n[0])):this._augmentationReplyJson.Set({ContentModel:ContentModels.None,ContentInHtml:"",PageMetadata:null});i=this._augmentationReplyJson.Get().ContentModel;i===ContentModels.None||this._augmentationReplyJson.Get().ContentInHtml===""?(Diag.ULS.sendTraceTag(7382666,403,Diag.ULSTraceLevel.info,"No notable content found. sessionId: {0}, textStatus: {1}, duration: {2}",SessionId,t,r),this._augmentationApiStatus.Set(2)):(f=this.UpdateAugmentationButtonForContentModel(i),f?(u="",this._augmentationReplyJson.Get().PageMetadata!=null&&(u=this._augmentationReplyJson.Get().PageMetadata.AutoPageTags),Diag.ULS.sendTraceTag(7382668,403,Diag.ULSTraceLevel.info,"Augmentation successful. sessionId: {0}, textStatus: {1}, duration: {2}, contentModel: {3}, classification: [{4}]",SessionId,t,r,ContentModels[i],u)):Diag.ULS.sendTraceTag(7382667,403,Diag.ULSTraceLevel.error,"Content was found, but not all corresponding UI properties were not found! sessionId: {0}, textStatus: {1}, duration: {2}, contentModel: {3}, locStringFound: {4}, imgResourceFound: {5}",SessionId,t,r,ContentModels[i],EnumToLocalizedStrings[i]!=="",EnumToButtonImgUris[i]!==""),this._augmentationMode=ContentModels[i],this._augmentationApiStatus.Set(1))},i.prototype.HandleAugmentationApiFailure=function(n,t,i){var e=new Date,o=e.getTime()-this._augmentationApiCallStartTime.getTime(),u=0,f=!0,r=JSON.parse(n.responseText);r&&r.error&&typeof HandledExtendedResponseCodes[r.error.code]!="undefined"&&(u=r.error.code,f=HandledExtendedResponseCodes[u].TreatAsAce);Diag.ULS.sendTraceTag(7382669,403,Diag.ULSTraceLevel.error,"Augmentation returned failure. API CorrelationId: {0}, errorThrown: {1}, extendedErrorCode: {2}, treatAsAce: {3}, textStatus: {4}, duration: {5}",n.getResponseHeader("X-CorrelationId"),i,u,f,t,o);this._augmentationMode=ContentModels[0];this._augmentationApiStatus.Set(3)},i.prototype.SetupLocationPicker=function(){var n=this;clipSectionPicker=new SectionPicker("sectionPickerContainer",function(){n._stateMachine.ResizeClipperFrame()},this._oneNoteApi);clipSectionPicker.GetData()},i.prototype.RemoveSvgs=function(n){var r=this,i=$("<div/>").html(n).children(),u=$(i).find("img"),t;return $(u).each(function(n,t){r.EndsWith(t.src,".svg")&&t.parentNode.removeChild(t)}),t="",$(i).each(function(n,i){t+=$(i).prop("outerHTML")}),t},i.prototype.EndsWith=function(n,t){return n.indexOf(t,n.length-t.length)!==-1},i}();n.ClipperUI=i}(Clipper||(Clipper={}));window.onload=function(){Clipper.Polyfills.Init();var n=new Clipper.ClipperUI};